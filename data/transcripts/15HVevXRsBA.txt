 The following content is provided under a Creative Commons license. Your support will help MIT OpenCourseWare continue to offer high quality educational resources for free. To make a donation or to view additional materials from hundreds of MIT courses, visit MIT OpenCourseWare at ocw.mit.edu. Last time we saw things about gradients and directional derivatives. Before that, we studied how to look for minima and maxima functions of several variables. And today we are going to look again at min-max problems, but in a different setting, namely when the variables are not independent. And so, what we will see is the method of Lagrange multipliers. And, this is the one point in the term when I can shine with my French accent and say Lagrange name properly. OK, so what are Lagrange multipliers about? Well, the goal is to minimize or maximize a function of several variables. Let's say, for example, f of x, y, z, three variables, but where these variables are no longer independent. So, they're not independent. That means that there's a relation between them. The relation is maybe some equation of the form g of x, y, z equals some constant. OK, so you take the relation between x, y, z. You call that g, and that gives you the constraint. And, the goal is to minimize f only of those values of x, y, z that satisfy the constraint. So, what's one way to do that? Well, one way to do that, if the constraint is very simple, we can maybe solve for one of the variables. OK, maybe we can solve this equation for one of the variables, plug back into f, and then we have a usual min-max problem that we've seen how to do. The problem is sometimes you can't actually solve for x, y, z in here because this condition is too complicated. And then, we need a new method. And, that's what we are going to do. OK, so why would we care about that? Well, one example is actually in physics. Maybe you've seen in thermodynamics that you study quantities about gases, and there's quantities that involve pressure, volume, and temperature. And, pressure, volume, and temperature are not independent of each other. I mean, you know probably the equation PV equals nRT. And, of course, there you could actually solve to express things in terms of one or the other. But, sometimes it's more convenient to really keep all three variables, but treat them as constraint. So, that's just an example of a situation where you might want to do this. Anyway, we'll look mostly at mathematical examples. But, just to point out that this is useful when you study gases in physics. So, the first observation is we can't use our usual method of looking for critical points of F because critical points of F, typically, they will not satisfy this condition. So, they won't be good solutions. We need something else. OK, so, well, let's look at an example, and we'll see how that leads us to the method. OK, so, for example, let's say that I want to find the point closest to the origin. On the hyperbola, x, y equals three in the plane. OK, so, that means I have this hyperbola, and I'm asking myself, what's the point on it that's the closest to the origin? I mean, we can solve this by elementary geometry. We don't need, actually, Lagrange multipliers, but we are going to do it with Lagrange multipliers because Lagrange multipliers are a pretty good example. So, what does it mean? Well, it means, really, we want to minimize distance to the origin. So, what's the distance to the origin? If I have a point at coordinates x, y, then the distance to the origin is square root of x squared plus y squared. Well, do we really want to minimize that, or can we minimize something easier? Maybe we can minimize the square of the distance. OK, so let's forget this guy. And, instead, so, actually, we'll minimize f of x, y equals x squared plus y squared. That looks better. Subject to the constraint, x, y equals three. And so, we'll call this thing g of x, y to illustrate the general method. So, let's look at the picture. So, here you can see, in yellow, the hyperbola x, y equals three. And, we're going to look for the points that are closest to the origin. So, what can we do? Well, for example, we can plot the function x squared plus y squared, function f. That's the contour plot of f with a hyperbola on top of it. And, now, let's see what we can do with it. Well, let's ask ourselves, for example, if I look at points where f equals 20, now, I think I'm at 20, but you can't really see it, that's a circle, that's a point whose distance square is 20. Well, can I find a solution if I'm on the hyperbola? Yes, there are four points at this distance. OK, can I do better? Well, let's decrease the distance. Yes, we can still find points on the hyperbola, and so on. Well, except if we go too low, then there's no points on this circle anymore on the hyperbola. So, if we decrease the value of f that we want to look at, there's somehow a limit value beyond which we can't go, and that's the minimum of f. OK, so we're trying to look for the smallest value of f that will actually be realized on the hyperbola. So, when does that happen? Well, I have to backtrack a little bit. It seems like the limiting case is basically here. It's when the circle is tangent to the hyperbola. That's the smallest circle that will hit the hyperbola. OK, so if I take a limit value of f, if I take a larger value of f, I will have solutions. If I take a smaller value of f, I will not have any solutions anymore. So, that's the situation that we want to solve for. OK, so how do we find that minimum? Well, the key observation that's valid on this picture, and that actually will remain true in the completely general case, is that when we have a minimum, the level curve of f is actually tangent to our hyperbola. It's tangent to our constraint, I mean, to the set of points where x, y equals three to the hyperbola. OK, so let's write that down. We observe that at the minimum, the level curve of f is tangent to the hyperbola. And, remember, the hyperbola is given by the equation g equals three, so it's a level curve of g. OK, so we have a level curve of f and a level curve of g that are tangent to each other. And, I claim that's going to be the general situation that we are interested in. So, how do we look for, try to solve for points where this happens? How do we find x, y where the level curves of f and g are tangent to each other? Well, so let's think for a second. If the two level curves are tangent to each other, that means that they have the same tangent line, right? If they have the same tangent line, that means that the normal vectors should be parallel. OK, let me maybe draw a picture here. So, this is the level curve, maybe f equals something. And, this is the level curve g equals constant. Here, my constant is three. Well, if I look at the gradient vectors, so the gradient of f will be perpendicular to the level curve of f. The gradient of g will be perpendicular to the level curve of g. They don't have any reason to be of the same size, OK, but they have to be parallel to each other. Of course, they could also be parallel pointing in opposite directions. But, the key point is that when this happens, the gradient of f is parallel to the gradient of g. Well, let's check that. OK, so here's a point. And, I can plot the gradient of f in blue, and the gradient of g in yellow. And, you see, in most of these places, somehow the two gradients are not really parallel. Actually, I shouldn't be looking at random points. I should be looking only on the hyperbola, right? I want points on the hyperbola where the two gradients are parallel. Well, when does that happen? Hmm, looks like it will happen here. OK, so, see, when I'm at the minimum, the two gradient vectors are parallel. OK, it's not really a proof. It's an example, but it seems to be convincing. So far, things work pretty well. OK, so how do we decide if two vectors are parallel? Well, they're parallel when they're proportional to each other. So, you can write one of them as a constant times the other one. And, that constant, usually, when used is the Greek letter lambda. OK, I don't know if you've seen it before. It's the Greek letter for the L. And, probably, I'm sure that's somebody's idea of paying a tribute to Lagrange by putting an L in there. OK, so lambda is just a constant. And, we are looking for a constant, lambda, and points x and y where this holds. So, in fact, what we are doing is we are replacing min-max problem in two variables with a constraint between them by a set of equations involving, you will see, three variables. So, we have min-max with two variables, x and y, but not independent. We had a constraint, g of x, y equals constant. And, that becomes something new. That becomes a system of equations where we have to solve, well, so let's write down what it means for gradient F to be proportional to gradient g. That means that F sub x should be lambda times g sub x, and F sub y should be lambda times g sub y, right, because the gradient vectors here are F sub x, F sub y, and g sub x, g sub y. If you have a third variable, z, then you have also an equation, g of x, y equals lambda g sub z. Now, let's see. How many unknowns do we have in these equations? Well, there's x, there's y, and there's lambda. So, we have three unknowns. We have only two equations. Something is missing. Well, yeah, I mean, x and y are not actually independent. They are related by the fact that g of x, y equals c. So, we need to add the constraint g equals c. And now, we have three equations involving three variables. OK, let's see how that works. So, here, remember, we have F equals x squared plus y squared, and g equals x, y. OK, so, what's F sub x? That's going to be 2x equals lambda times, what is g sub x, y. OK, so, maybe I should write here F sub x equals lambda g sub x, just to remind you. Then, we have F sub y equals lambda g sub y. Why does that, what, so, F sub y is 2y equals lambda times g sub y is x. And then, our third equation, g equals c, becomes x, y equals three. OK, so, that's what we would have to solve. OK, any questions at this point? No? Yes? Ah, how do I know the direction of a gradient? Do you mean, how do I know that it's perpendicular to the level curve? Oh, how do I know whether it points in that direction or in the opposite one? Well, that depends. I mean, we've seen, actually, last time that the gradient is perpendicular to the level, and points towards higher values of a function. So, it could be, wait, what did I have? Yeah, it could be that my gradient vectors up there actually point in opposite directions. It doesn't matter to me because it will still look the same in terms of the equation, just lambda will be positive or negative depending on the case. OK, so, I can handle both situations. It's not a problem. So, yeah, I can allow lambda to be positive or negative. And, well, in this example, it looks like lambda will be positive if you look at the picture on the plot. Yes? Well, because actually they are not equal to each other. If you look at, you know, so if you look at this point where the hyperbola and the circle touch each other, well, so first of all, I don't know which circle I'm going to look at. I'm trying to solve, actually, for the radius of the circle. I'm trying to find what's the minimum value of f. And, second, at that value of f, actually, at that point, the value of f and the value of g are not equal. g is equal to three because I'm on the hyperbola x equals three. The value of f will be the square of the distance, whatever that is. I think it will end up being six, but we'll see. OK, so you can't really set them equal because you don't know what f is equal to in advance. Yes? Not quite. No, we are not, so, I mean, actually, here I'm just using this idea of finding a point closest to the origin to illustrate an example of a min-max problem. The general problem we are trying to solve is minimize f subject to g equals constant. And, what we are going to do for that is we are really going to say instead, let's look at places where gradient f and gradient g are parallel to each other and solve for equations of that. I think we completely lose the notion of closest point if we just look at these equations. We don't really say anything about closest points anymore. Of course, that's what they mean in the end. But, in the general setting, there's no closest point involved anymore. Just that. Yes? Yes, so it's always going to be the case that at the minimum, or at the maximum of a function subject to a constraint, the level curves of f and the level curves of g will be tangent to each other. So, that's the basis for this method. OK, so I'm going to justify that soon. Yes, it could be minimum or maximum. Or, in three dimensions, it could even be a saddle point. And, in fact, I should say in advance, this method will not tell us whether it's a minimum or a maximum. We don't have any way of knowing except for testing values. We can't use second derivative tests or anything like that. OK, I'll get back to that. Yes? Ah, yes. Here, you can set y equals to three over x. And then, you can minimize x squared plus nine over x squared. In general, if I'm trying to solve a more complicated problem, I might not be able to solve. OK, so I'm doing an example where, indeed, here you could solve and remove one variable. But, you can't always do that. This method will still work. The other one won't. OK, I don't see any other questions. Are there any other questions? OK, then I see a lot of you suddenly stretching and so on. So, it's very confusing for me. OK, so how do we solve these equations? Well, the answer is, in general, we might be in deep trouble. OK, there's no general method for solving the equations that you get from this method. You just have to think about them. And, so, you know, sometimes it will be very easy. Sometimes it will be so hard that you can't actually do it without a computer. Sometimes it will be just hard enough to be on Part B of this week's problem set. OK, so in this case, I claim in this case we can actually do it without so much trouble. OK, because actually we can think of this as a two by two linear system in x and y. Well, let me do something. OK, so let me rewrite the first two equations as 2x minus lambda x, and lambda x minus 2y equals zero, and xy equals three. Right, that's what we want to solve. Well, I can put this into matrix form, two minus lambda, two times xy equals zero. Now, how do I solve a linear system matrix times xy equals zero? Well, I always have an obvious solution, OK, x and y both equal to zero. Is that a good solution? No, because zero times zero is not free. OK, so we want another solution. So, the trivial solution, zero, zero, does not solve the constraint equation, xy equals three. So, we want another solution. When do we have another solution? Well, when the determinant of the matrix is zero. OK, so we have other solutions exist only if the determinant of a matrix is zero, and where M is this guy. OK, so let's compute the determinant of M. Well, that seems to be negative four plus lambda squared. So, that's zero exactly when lambda squared equals four, which is lambda is plus or minus two. OK, so already you see here it's at the level of difficulty that's a little bit much for an exam, but perfectly fine for a problem set or for a beautiful lecture like this one. OK, so how do we deal with, well, we have two cases to look at, lambda equals two or lambda equals minus two. Let's start with lambda equals two. If I set lambda equals two, what does this equation become? Well, it becomes x equals y. This one becomes y equals x. Well, they seem to be the same, OK, x equals y. And then the equation xy equals three becomes, well, x squared equals three. So, I have two solutions. One is x equals root three, and therefore y equals root three, or negative root three, negative root three. OK, let's look at the other case. Well, if I set lambda equal to negative two, then I get 2x equals negative 2y. That means x equals negative y. The second one, 2y equals negative 2x. That's y equals negative x. That's the same thing. And, xy equals three becomes, well, negative x squared equals three. Can we solve that? No, OK, so there's no solutions here. So, now we have two candidate points, which are these two points, root three, root three, or negative root three, negative root three. OK, so let's actually look at what we have here. Well, maybe you can't read the coordinates, but actually the point that I have here is, indeed, root three, root three. And, how do we see that lambda equals two? Well, if you look at this picture, the gradient of f, that's the blue vector, is, indeed, twice the yellow vector, gradient g. OK, that's where you read the coordinates. And, we have the other solution, which is somewhere here, negative root three, negative root three. And, there, again, lambda equals two. The two vectors are proportional by a factor of two. Yes? No, solutions are not quite guaranteed to be absolute minima or maxima. They're guaranteed to be critical points under the constraint. So, that means, if you were able to solve and eliminate a variable, they would be critical points. So, then, you have the same problem as with critical points. Are they maxima or minima? And, the answer is, well, we won't know until we check. OK, more questions? No, yes? So, what is a Lagrange multiplier? Well, it's this number lambda is called the multiplier here. OK, it's multiplier because it's what you have to multiply gradient of g by to get gradient of f. So, it multiplies. OK, so let's try to see why is this method valid? Because, you know, I've shown you pictures, and I've said, well, see, they're tangent. But, why is it that they have to be tangent in general? OK, so, let's think about it. Let's say that we are at a constraint min or max. So, what that means is that if I move on the level g equals constant, then the value of f should only increase or only decrease. But, it means, in particular, to first order, it will not change. OK, that's, you know, so at an unconstrained min or max, the partial derivatives are zero. In this case, the derivatives are zero only in the allowed directions. And, the allowed directions are the direction on the level surface g equals constant. OK, so, in any direction along the level set g equals c, the rate of change of f must be zero. OK, that's what happens at minima or maxima. Except here, of course, we look only at the allowed directions. OK, so, let's say the same thing in terms of directional derivatives. OK, so, that means for, so, that means for any direction that's tangent to g equals c, we must have df ds in the direction of u equals zero. OK, let me maybe draw a picture. So, let's say now I'm in free space. Just to, you know, give you different examples. So, here I have a level surface g equals c. I'm at my point. And, if I move in any direction that's on the level surface, so, I move in the direction u that's tangent to the level surface, then the rate of change of f in that direction should be zero. OK, now, remember what's the formula for this guy? Well, we've seen that this guy is actually gradient f dot u. So, that means any such vector u must be perpendicular to the gradient of f. Well, so, that means that the gradient of f should be perpendicular to anything that's tangent to this level. So, that means the gradient of f must be perpendicular to the level set. That's what we've shown. But, we know another vector is also perpendicular to the level set of g. So, we conclude that the gradient of f must be parallel to the gradient of g because both are perpendicular to the level set of g. OK, I see confused people there. I see confused faces. So, let me try to tell you again where that comes from. So, we say if we have a constraint minimum or maximum, if we move in the level set of g, f doesn't change. Well, it doesn't change to first order. Remember, it's the same idea as when you're looking for a minimum, you set the derivative equal to zero. OK, so, the derivative in any direction tangent to g equals c should be, the directional derivative of f in any such direction should be zero. That's what we mean by critical point of f. And so, that means that any vector, u hat, any unit vector tangent to the level set of g is going to be perpendicular to the gradient of f. So, that means that the gradient of f is perpendicular to the level set of g. If you want, that means the level sets of f and g are tangent to each other. OK, so that's justifying what we've observed on the picture, that the two level sets have to be tangent to each other at the constraint minimum or maximum. OK, does that make a little bit of sense? Kind of. I see at least a few faces nodding, so I'll take that to be a positive answer. OK, so, since I've been asked by several of you, how do I know if it's a maximum or a minimum? Well, warning, the second derivative test doesn't tell whether a solution is a minimum or a maximum. OK, so, how do we do it? Well, more bad news, we can't use the second derivative test. And, the reason for that is that we care actually only about these specific directions that are tangent to the level of g. And, we don't really, I mean, we don't want to bother to try to define directional second derivatives, not to mention that actually it wouldn't work. There is a criterion, but it's much more complicated than that. So, basically, the answer for us is we don't have a second derivative test in this situation. So, what are we left with? Well, we're just left with comparing values. Say that in this problem you found a point where f equals three, a point where f equals nine, a point where f equals 15. Well, then probably the minimum is the point where f equals three, and the maximum is 15. Actually, in this case, well, we found minima. These two points are tied for minimum. What about the maximum? What's the maximum of f and the hyperbola? Well, it's infinity because the point can go as far as you want from the origin. So, but the general idea is if we have a good reason to believe that there should be a minimum, and it's not like at infinity or something weird like that, then the minimum will be a solution of the Lagrange multiplier equations. So, we just look for all the solutions, and then we choose the one that gives us the lowest value. So, let me actually write that down. To find the minimum or the maximum, we compare the values of f at the various solutions to the Lagrange multiplier equations. OK, let's do, well, sorry, I should say also sometimes you can just conclude by thinking geometrically. I mean, in this case, when it's asking you which point is closest to the origin, you can just see that your answer is the correct one. OK, let's do an advanced example. OK, advanced means that, well, this one I didn't actually dare to put on part B of the problem set. So, instead, I'm going to do it. OK, so, what is this going to be about? We're going to look for a surface minimizing pyramid. OK, so, let's say that we want to minimize a pyramid with a given triangular base and a given volume. And, so, say that I have maybe, in the xy plane, I'm giving you some triangle. And, I'm going to try to build a pyramid. So, I have to find where to put, because I can choose where to put the top of the pyramid. This guy will end up being the pyramid. And, the goal is to minimize the total surface area. OK, so, first time I taught this class, it was like a few years ago. It was just before they built the Stata Center. And, then I used to motivate this problem by saying, well, this guy, Ray, has gone crazy. And, he's given a triangular plot of land. He wants to put a pyramid. There needs to be the right amount of volume so that you can put all the offices in there. And, he wants it to be, actually, covered in solid gold. And, because that's expensive, the MIT administration wants him to cut the costs a bit. And so, you have to minimize the total size so that it doesn't cost too much. We'll see if MIT comes up with a triangular pyramid building. Hopefully not. This could be our next term. You never know. OK, anyway, it's a fine geometry problem. And, let's try to think about how we can do this. So, the natural way to think about it would be, well, what we have to look for first. What do we have to look for? We have to look for the volume. Well, remember, we know that the volume of a pyramid is one third of area of the base times height. OK, so, in fact, fixing the volume, knowing that we have fixed the area of the base, means that we're fixing the height of the pyramid. OK, so, the height is completely fixed. What we have to choose just is where do we put that top point? Do we put it smack in the middle of a triangle, or to a side, or even anywhere we want? But, its z coordinate is fixed. OK, let's call h the height. So, what we could do is something like this. We say, well, we have three points in the base. Let's call them P1 at x1, y1, 0, P2 at x2, y2, 0, P3 at x3, y3, 0. This point P is the unknown point at x, y, h. Well, at least we know the height. And then, we want to minimize the sum of the areas of these three triangles that are one here, one here, and one at the back. And, areas of triangles, we know how to express using length of cross product. So, that becomes a function of x and y. And, you can try to minimize it. And, actually, it doesn't quite work. The formulas are just too complicated. You never get there. So, what happens is actually, maybe we need better coordinates. Why do we need better coordinates? That's because the geometry is kind of difficult to do if you use x, y coordinates. I mean, formula for cross product is fine, but then the length of a vector will be annoying, and it just doesn't look good. So, instead, let's think about it differently. Oh, I have one more board. OK, so I claim if we do it this way, and we express, then, the area as a function of x, y, well, actually, we can't solve for the minimum. So, here's another way to do it. Well, what's worked pretty well for us so far is this geometric idea of base times height. So, let's think in terms of the heights of these side triangles. OK, so I'm going to use the heights of these things. And, I'm going to say that the area will be the sum of three terms, which are three bases times three heights. So, let's give names to these quantities. So, actually, for that, it's going to be good to have the point in the x, y plane that lives directly below P. Let's call Q. So, P is the point that coordinates x, y, and h. And, let's call Q the point that lives below it. So, it coordinates x, y, zero. OK, so let's see. Let me draw a picture, actually. Let me draw a map of this thing seen from above. So, you have P1, P2, P3. I have my point Q in the middle. So, let's see. To know these areas, I need to know the base. Well, the base, I can decide that I know it because it's part of my given data, right? I know the size of this triangle. Let me call the lengths a1, a2, a3. I also need to know the heights. So, I need to know these lengths. How do I know these lengths? Well, it's a distance in space. That's a little bit annoying. But, maybe I can reduce it to a distance in the plane by looking instead at this distance here. OK, so let me give names to the distances from Q to the sides. OK, so let's call u1, u2, and u3 the distances from Q to the sides. Well, now I claim I can find, actually, sorry, I need to draw one more thing. I claim I have a nice formula for the area because this side, so, this is vertical and that's horizontal. So, this length here is u3. This length here is h. So, what's this length here? Yeah, it's square root of u3 squared, oops, plus h squared. And, similarly, for these other guys, they're square roots of u squared plus h squared. OK, so the heights of the faces are square root of u1 squared plus h squared, and similarly with u2 and u3. So, the side, the total side area is going to be, well, area of the first face is one half of base times other height plus one half of other base times other height plus one half of third one. It doesn't look so much better, but trust me, it will get better. OK, so now that's a function of three variables, u1, u2, u3. And, how do we relate u1, u2, u3 to each other? They're probably not independent. Well, let's cut this triangle here into three pieces like that. Then, each piece has side, well, let's look at, say, the piece at the bottom. It has base a3, u3. So, cut the base into three tells you that the area of the base is one half of a1u1 plus one half of a2u2 plus one half of a3u3. And, that's our constraint. OK, so my three variables, u1, u2, u3 are constrained in this way. The sum of these three guys must be the area of the base. And, I want to minimize that guy. So, that's my g. OK, and that guy here is my f. So, now if I write the Lagrange multiplier equations, well, partial f over partial u1 is, well, if you do the calculation, you will see it's one half a1u1 over square root of u1 squared plus h squared should be lambda times what's partial g partial u1. That's what you can do, I'm sure. It's one half a1. Oh, this guy is simplified. OK, if you do the same with the second one, things simplify again. And, same with the third one. Well, you will get, after simplifying, u3 over square root of u3 squared plus h squared equals lambda. So, now that means this guy equals this guy equals this guy. They're all equal to lambda. And, if you think about it, that means that u1 equals u2 equals u3. See, it looks like scary equations, but the solution is very simple. So, what does it mean? It means that our point Q should be equidistant from all three sides. That's called the in-center. So, Q should be the in-center. So, the next time that you have to build a golden pyramid and don't want to go broke, well, you know where to put the top. OK, if that was a bit fast, sorry. Anyway, it's not completely crucial, but go over it. And, hopefully, it works. Have a nice weekend.