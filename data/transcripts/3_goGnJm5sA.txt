 The following content is provided under a Creative Commons license. Your support will help MIT OpenCourseWare continue to offer high quality educational resources for free. To make a donation or to view additional materials from hundreds of MIT courses, visit MIT OpenCourseWare at ocw.mit.edu. Today we are going to continue looking at critical points. And we will learn how to actually decide whether a critical point is a minimum, a maximum or a saddle point. That is the main topic for today. Remember, yesterday we looked at critical points of functions of several variables. A critical point of a function, say, of two variables, x and y, that is a point where the partial derivatives are both zero. And we have seen that there are various kinds of critical points. There is local minima. Maybe I should show the function and its contour plot. There is local maxima, which are like that. And there are saddle points which are neither minima nor maxima. And, of course, if you have a real function then it will be more complicated. It will have several critical points. This example here, well, you see on the plot that there are two maxima. And in the middle between them there is a saddle point. And, actually, you can see them on the contour plot. On the contour plot you see the maxima because the level curves become circles that narrow down and shrink to the maximum. And you can see the saddle point because here you have this level curve that makes a figure eight. It crosses itself. And if you move up or down here then, so along the y direction, the values of the function will decrease. Along the x direction the values will increase. You can see, usually, quite easily where are the critical points just by looking either at the graph or at the contour plot. The only thing with the contour plot is you need to read the values to tell a minimum from a maximum because the contour plots look the same. Just, of course, in one case the values increase and in the other one they decrease. The question is how do we determine the minimum between various possibilities, local minimum, local maximum or saddle point? And, in fact, why do we care? Well, the other question is how do we find the global minimum or maximum of a function? Here, I should point out, well, first of all, to decide where the function is the largest, in general, you will have to compare the values. For example, here, if you want to know what is the maximum of this function, well, we have two obvious candidates. We have this local maximum and that local maximum. And the question is which one is the higher of the two? Well, in this case, actually, they are exactly tied for maximum. But, in general, you would have to compute the function at both points and compare the values. If you know that it is three at one of them and four at the other, well, four wins. The other thing that you see here is if you are looking for the minimum of this function, well, the minimum is not going to be at any of the critical points. So, where is the minimum? Well, it looks like the minimum is actually out there on the boundary or at infinity. So, that is another feature of the global minimum or maximum. It doesn't have to be at a critical point. It could also be somehow on the side, in some limiting situation where one variable stops being in the allowed range of values or goes to infinity. We have to actually check the boundary and the infinity behavior of our function to know where, actually, the minimum and maximum will be. In general, I should point out, this could occur either at a critical point or on the boundary or at infinity. By that I mean on the boundary of a domain of definition that is not a critical point. And so, we have to try both. OK, so we'll get back to that. For now, let's try to focus on the question of what's the type of the critical point? So, we'll use something that's known as the second derivative function. And, in principle, well, the idea is kind of similar to what you do with a function of one variable, namely, function of one variable. If the derivative is zero, then you know that you should look at the second derivative. And, that will tell you whether it's curving up or down, whether you have a local max and a local min. And, the main problem here is, of course, we have more possible situations, and we have several derivatives. So, actually, we have to think a bit harder about how we'll decide. But, it will again involve the second derivatives. OK, so let's start with just an easy example that will be useful to us because, actually, it will provide the basis for the general method. OK, so we are first going to consider a case where we have a function that's actually just quadratic. So, let's say I have a function w of x, y that's of the form ax squared plus bxy plus cy squared. OK, so this guy has a critical point at the origin, right, because if you take the derivative with respect to x, well, and if you plug x equals y equals zero, you'll get zero, and same with respect to y. You can also see, if you try to do a linear approximation of this, well, all these guys are much smaller than x and y when x and y are small. So, the linear approximation, the tangent plane to the graph is really just w equals zero. OK, so how do we do it? Well, yesterday, we actually did an example. It was a bit more complicated than that, but let me do it. So, remember, we were looking at something like 2xy plus 3y squared. And, there were other terms, but let's forget them now. And, what we did is we said, well, we can rewrite this as x plus y squared plus 2y squared. And now, this is a sum of two squares. So, each of these guys has to be non-negative, and so the origin will be a minimum. Well, it turns out we can do something similar in general, no matter what these values of a, b, and c are. We'll just try to first complete things to a square. OK, so let's do that. So, in general, well, that may be slightly less general. And, let me assume that a is non-zero because otherwise I can't do what I'm going to do. So, I'm going to write this as a times x squared plus b over a xy. Then, I have my cy squared. And now, this looks like the beginning of the square of something, OK, just like what we did over there. So, what is it the square of? Well, you'd start with x plus, I claim if I put b over 2a y, and I square, then, see the term, the cross term, 2 times x times b over 2ay will become b over a xy. Of course, now, I also get some y squares out of this. How many y squares do I get? Well, I get b squared over 4a squared times a. So, I get b squared over 4a y squared. So, and I want, in fact, c times y squared. So, the number of y squared that I should add is c minus b squared over 4a. OK, let's see that again. If I expand this thing, I get ax squared plus a times b over 2a times 2xy. That's going to be my bxy. But, I also get b squared over 4a squared y squared times a. That's b squared over 4ay squared. And, that cancels out with this guy here. And then, I will be left with cy squared. OK, do you see it, kind of? OK, if not, well, try expanding this square again. OK, maybe I'll do it just to convince you. So, if I expand this, I will get a times, let me put that in a different color because you shouldn't write that down. It's just to convince you that you can see it. If you don't see it yet, let's expand this thing. We'll get a times x squared plus a times 2xb over 2ay. Well, the two a's cancel out. We get bxy plus a times the square of that. That's going to be b squared over 4a squared y squared plus cy squared minus b squared over 4ay squared. Here, the a simplifies. And now, these two terms simplify and give me just cy squared in the end. OK, and that's kind of unreadable after I've canceled out the whole thing. But, if you follow it, you see that basically I've just rewritten my initial function. OK, is that kind of OK? I mean, otherwise, there's just no substitute. You'll have to do it yourself, I'm afraid. OK, so let me continue to play with this. So, I'm just going to put this in a slightly different form just to clear up the denominators. OK, so I will instead write this as one over 4a times the big thing. So, I'm going to just put 4a squared times x plus b over 2ay squared. OK, so far I have the same thing as here. OK, I just introduced a 4a that cancels out. Plus, for the other one, I'm just clearing the denominator. I end up with 4ac minus b squared y squared. OK, so that's a lot of terms. But, what does it look like? Well, it looks like, so we have some constant factors. And, here we have a square, and here we have a squared. So, basically, we've written this as a sum of two squares. Well, a sum or a difference of two squares. And, maybe that's what we need to figure out to know what kind of point it is. Because, see, if you take a sum of two squares, then you'll know that each square takes non-negative values, and you'll have the total, you know, the function will always take non-negative values. So, the origin will be a minimum. Well, if you have a difference of two squares, then typically you'll have a saddle point because, depending on whether one or the other is larger, you'll have a positive or a negative quantity. OK, so I claim there's various cases to look at. So, let's see. So, in fact, I claim there will be three cases. And, that's good news for us because, after all, we want to distinguish between three possibilities. So, let's first do away with the most complicated one. What if 4ac-b2 is negative? Well, if it's negative, then it means what I have between the brackets is, so the first guy is obviously a positive quantity, while the second one will be something negative times y2. So, it will be a negative quantity. OK, so one term is positive. The other is negative. That tells us we actually have a saddle point. We have, in fact, written our function as a difference of two squares. OK, is that convincing? So, if you want, what I could do is actually I could change my coordinates, have new coordinates called, I don't know, u equals x plus b over 2ay, and v, actually, well, I could keep y, and then it would look like a difference of squares directly. OK, so that's the first case. The second case is where 4ac-b2 equals zero. Well, what happens if that's zero? Then it means that this term over there goes away. So, what we have is just one square. OK, so what that means is actually that our function depends only on one direction of things. In the other direction, it's going to actually be degenerate. So, for example, forget all the clutter in there. Say I give you just the function of two variables, w equals just x2. So, that means it doesn't depend on y at all. And, if I try to plot the graph, it will look, well, so x is here. So, it will depend on x in that way, but it doesn't depend on y at all. So, what the graph looks like is something like that. OK, basically, it's a valley whose bottom is completely flat. So, that means, actually, we have a degenerate critical point. It's called degenerate because there's a direction in which nothing happens. And, in fact, you have critical points everywhere along the y-axis. OK, so now, whether the square that we have is x or something else, namely x plus b over 2ay, it doesn't matter. I mean, we'll still get this degenerate behavior, but there's a direction in which nothing happens because we just have the square of one quantity. I'm sure that 300 students means 300 different ringtones, but I'm not eager to hear all of them. Thanks. OK, so this is what's called a degenerate critical point. And, OK, so basically, we'll leave it here. We won't actually try to figure out further what happens. And, the reason for that is that when you have an actual function, a general function, not just one that's quadratic like this, then there will actually be other terms maybe involving higher powers, maybe x3 or y3 or things like that. And then, they will mess up what happens in this valley. And, it's a situation where we don't actually need to tell automatically just by looking at second derivatives what happens. See, for example, in the function of one variable, if you have just the function of one variable, say, f of x equals x to the five, well, if you try to decide what type of point the origin is, you're going to take the second derivative. It will be zero. And then, you can conclude because things depend on higher order derivatives. So, we just won't like that situation. We just won't try to figure out what's going on here. Now, the last situation is if 4ac minus b squared is positive. So, then that means that actually we've written things, the big bracket up there is a sum of two squares. OK, so that means that we've written w as one over 4a times plus something squared plus something else squared. OK, so these guys have the same sign. And, that means that this term here will always be greater or equal to zero. And so, that means that we should have either a maximum or a minimum. How do we decide which one it is? Well, we look at the sign of a exactly. OK, so there's two subcases. One is if a is positive, then this quantity overall will always be non-negative. And, that means we have a positive quantity. And, if a is negative, on the other hand, so that means that if we multiply this positive quantity by a negative number, we get something that's always negative. So, zero is actually the maximum. OK, is that clear for everyone? Yes? Sorry, so, yeah, I said in the example w equals x squared, it doesn't depend on y. If I have, so the marginal situation is w equals some constant, well, I guess it's a times x plus b over 2a times y squared. So, it does depend on x and on y, but it only depends on this combination. OK, so if I choose to move in somehow the perpendicular direction, in the direction where this remains constant, so maybe if I set x equals minus b over 2ay, then this remains zero all the time. So, there's a degenerate direction in which I stay at the minimum or maximum or whatever it is that I have. OK, so that's why it's called degenerate. There's a direction in which nothing happens. OK, yes? Yes, yeah, so that's a very good question. So, I say there's going to be a second derivative test. Why do we not have derivatives yet? Well, that's because I've been looking at this special example where we have a function like this. And so, I don't actually need to take derivatives yet. But, that's secretly because a, b, and c will be the second derivatives of a function, actually, 2a, b, and 2c. So, now we are going to go to a general function. And there, instead of having these coefficients a, b, and c given to us, we'll have to compute them as second derivatives. OK, so here I'm basically setting the stage for what will be the actual criterion we'll use using second derivatives. Yes? So, yes, so when you have a degenerate critical point, it could be a degenerate minimum or a degenerate maximum depending on the sign of a. But, in general, once you start having more complicated functions, you don't really know what will happen anymore. It could also be a degenerate saddle and so on. So, we won't really be able to tell. Yes? It is possible to have a degenerate saddle point. For example, if I give you x3 y3, you can convince yourself that if you take x and y to be negative, it will be negative. If x and y are positive, it's positive. And, it has a very degenerate critical point at the origin. So, that's a degenerate saddle point. You don't see it here because that doesn't happen if you have only quadratic terms like that. You need to have higher order terms to see it happen. OK, so let's continue. Oh, before we continue, let's see, I wanted to point out one small thing. So, here we have this magic quantity, 4ac minus b2. You've probably seen that before in your life. Yeah, it looks like the quadratic formula except that one involves b2 minus 4ac. But, that's really the same thing. OK, so let's see. Where does the quadratic formula come from? Well, let me write things differently. OK, so we've manipulated things and gotten to a conclusion. But, let me just do a different manipulation and write this now instead as y2 times a times x over y2 plus bx over y plus c. OK, see, that's the same thing that I had before, right? Well, so now, this quantity here is always non-negative. What about this one? Well, of course, this one depends on x over y. It means it depends on which direction you're going to move away from the origin, which ratio between x and y you will consider. But, I claim there's two situations. One is, so let's try to reformulate things. So, if a discriminant here is positive, then it means that this has roots, right? This has solutions. That means that this quantity can be both positive and negative. This quantity takes positive and negative values. One way to convince yourself that, if you take a t squared plus b t plus c, you know that there's two roots. So, it might look like this, or it might look like that depending on the sign of a. But, in either case, it will take values of both signs. So, that means that your function will take values of both signs. The value takes both positive and negative values. And so, that means we have a saddle point. While the other situation, when b squared minus 4ac is negative, means that this equation, this quadratic, never takes the value zero. So, it's always positive, or it's always negative depending on the sign of a. So, the other case is, if b squared minus 4ac is positive, then that quadratic doesn't have a solution. And, it could look like this or like that depending on whether a is positive or a is negative. So, in particular, that means ax over y squared plus bx over y plus c is always positive or always negative depending on the sign of a. And then, that tells us that our function w will be always positive or always negative. And then, we'll get a minimum or a maximum. OK, we'll have a min or a max depending on which situation we are in. OK, so that's another way to derive the same answer. And now, here you see why the discriminant plays a role. That's because it exactly tells you whether this quadratic quantity has always the same sign, or whether it can actually cross the value zero when you have a root of a quadratic. OK, so hopefully at this stage you're happy with one of the two explanations at least. And now, you're willing to believe, I hope, that we have basically a way of deciding what type of critical point we have in the special case of a quadratic function. OK, so now what do we do with a general function? Well, so in general, we want to look at second derivatives. OK, so now we are getting to the real stuff. So, how many second derivatives do we have? That's maybe the first thing we should figure out. Well, we can take the derivative first with respect to x, and then again with respect to x. OK, that gives us something we denote by partial square f over partial x squared, which is f sub xy. Then, there's another one, which is f sub xy, which means you take the derivative with respect to x, and then with respect to y. Another thing you can do is do first derivative with respect to y, and then with respect to x. That would be f sub yx. Well, good news. These are actually always equal to each other. OK, so it's a fact that we will admit. It's really not very hard to check. So, these are always the same. We don't need to worry about which one we do. That's one computation that we won't need to do. We can save a bit of effort. And then, we have the last one, namely the second partial with respect to y and y, f sub yy. OK, so we have three of them. So, what does the second derivative test say? It says, say that you have a critical point x0, y0 of a function of two variables, f. And then, let's compute the partial derivatives. So, let's call capital A the second derivative with respect to x. Let's call capital B the second derivative with respect to x and y. And, C equals f sub yy at this point. OK, so these are just numbers because we first compute the second derivative, and then we plug in the values of x and y at the critical point. So, these will just be numbers. And now, what we do is we look at the quantity AC minus B squared. I am not forgetting a four. You will see why very soon. So, if AC minus B squared is positive, then there are two subcases. If A is positive, then it is a local minimum. The second case, so still if AC minus B squared is positive, but A is negative, then it is going to be a local maximum. And, if AC minus B squared is negative, then it is a saddle point. And finally, if AC minus B squared is zero, then we actually cannot conclude. We don't know whether it is going to be a minimum, a maximum or a saddle. We know it is degenerating in some way, but we don't know what type of point it is. OK, so that is actually what you need to remember if you are formula oriented. That is all you need to remember about today. But let's try to understand how this comes out of what we had there. I think maybe I actually want to keep this middle board because it actually has the recipe that we found before for the quadratic function. Let me move directly over there and try to relate our old recipe with a new one. You are easily amused. OK, so first let's check that these two things say the same thing in the special case that we were looking at. Let's verify in the special case where the function was Ax squared plus Bxy plus Cy squared. Well, what is the second derivative with respect to x and x? If I take the second derivative with respect to x and x, first I want to take maybe the derivative with respect to x. Let's take first the first derivative with respect to w sub x. That will be 2Ax plus By. W sub xx will be, well, let's take the partial with respect to x again. That is 2A. W sub xy, I take the partial with respect to y, I will get B. Now we need also the partial with respect to y. W sub y is Bx plus 2Cy. In case you don't believe what I told you about the mixed partials, W sub yx, well, you can check. And it is again B. They are indeed the same thing. And W sub yy will be 2C. If we now look at these quantities, that tells us, well, big A is 2 little a, big B is little b, big C is 2 little c. AC minus B squared is what we used to call 4 little ac minus b squared. OK. Now you can compare the cases. Well, they are not listed in the same order just to make it harder. We said first, the subtle case is when ac minus b squared in big letters is negative. That is the same as 4ac minus b squared in lower case is negative. The case where capital AC minus b squared is positive, local min and local max, corresponds to this one. And the case where we cannot conclude was what used to be the degenerate one. At least we don't seem to have to worry about copying the formula. Now, why does that work more generally than that? Well, the answer to that is, again, Taylor approximation. OK, so let me just do here quadratic approximation. Quadratic approximation tells me the following thing. It tells me if I have a function f of x, y and I want to understand the change in f when I change x and y a little bit, well, there's the first order terms, the linear terms that by now you should know and be comfortable with. That's f sub x times the change in x. And then there's f sub y times the change in y. OK, that's the starting point. But now, of course, if x and y, sorry, if we are at the critical point, then that's going to be zero at the critical point. So, that term actually goes away. And that's also zero at the critical point. So, that term also goes away. OK, so linear approximation is really no good. We need more terms. So, what are the next terms? Well, the next terms are quadratic terms. And so, I mean, if you remember the Taylor formula for a function of a single variable, there was the derivative times x minus x0 plus one-half of the second derivative times x minus x0 squared. And see, this side here is really Taylor approximation in one variable looking only at x. But, of course, we also have terms involving y and terms involving simultaneously x and y. And these terms are f sub xy times change in x times change in y plus one-half of fyy times y minus y0 squared. And there is no one-half in the middle because, in fact, you would have two terms, one for xy, one for yx, but they are the same. And then, if you want to continue, there's actually cubic terms involving the third derivatives and so on, but we are not actually looking at them. And so, now, when we do this approximation, well, the type of critical point remains the same when we replace the function by this approximation. And so, we can apply the argument that we used to deduce things in the quadratic case. In fact, it still works in the general case using this approximation formula. OK, so the general case reduces to the quadratic case. And now, you see actually why, well, here you see again how this coefficient, which we used to call little a, is also one-half of capital A. And same here, this coefficient is what we call capital B or little b. And this coefficient here is what we called little c or one- half. And then, when you replace things into the various cases that we had here, you end up with the second derivative test. So, what about the degenerate case? Why can't we just say, well, it's going to be a degenerate critical point? So, the reason is that this approximation formula is reasonable only if the higher order terms are negligible. OK, so in fact, secretly there's more terms. This is only an approximation. There would be terms involving third derivatives, and maybe even beyond that. And so, in the non-degenerate case, they don't actually matter because the shape of the function, the shape of the graph is actually determined by the quadratic terms. But, in the degenerate case, see, if I start with this, and I add something even very, very small along the y-axis, then that can be enough to bend this value slightly up or slightly down, and turn my degenerate point into either a minimum or a saddle point. And, I won't be able to tell until I go further in the list of derivatives. So, in the degenerate case, what actually happens depends on the higher order derivatives. So, we need to analyze things more carefully. Well, we are not going to bother with that in this class. So, we'll just say, well, we cannot conclude. OK, I mean, you have to realize that in real life, you have to be extremely unlucky for this quantity to end up being exactly zero. Well, if that happens, then what you should do is maybe try by inspection, see if there's a good reason why the function should always be positive or always be negative or something. Or, you know, plot it on a computer and see what happens. But, otherwise, we can't conclude. OK, so let's do an example. So, probably I should leave this on so that we still have the test with us. And, instead, OK, so I'll do my example here. OK, so let's do an example. Let's say I look at f of x, y equals x plus y plus one over x, y where x and y are positive. So, I'm looking only at the first quadrant. OK, I mean, I'm doing this because I don't want this denominator to become zero. So, I'm just looking at that situation. So, let's look first for, so the question will be what are the minimum and the maximum of this function? So, the first thing we should do to answer this question is look for critical points. OK, so for that, we have to compute the first derivatives. So, f sub x is one minus one over x squared, y. OK, take the derivative of one over x, but negative one over x squared. And, we'll want to set that equal to zero. And, f sub y is one minus one over x, y squared. And, we want to set that equal to zero. So, what are the equations we have to solve? Well, I guess x squared y equals one. I mean, if I get this, you know, if I move this guy over here, I get one over x squared y equals one. That's x squared y equals one. And, x y squared equals one. What do you get by comparing these two? Well, x and y should both be, OK, so yeah, I agree with you that one and one is a solution. Why is it the only one? So, first, if I divide this one by that one, I get x over y equals one. So, that tells me x equals y. And then, if x equals y, then if I put that into here, it will give me y cubed equals one, which tells me y equals one and, therefore, x equals one as well. OK, so there's only one solution. There's only one critical point, which is going to be one comma one. OK, so now, here's where you do a bit of work. What do you think of that critical point? OK, I see some valid votes. I see a lot of people answering correctly. That seems to suggest that maybe, well, you haven't computed the second derivative yet. Yes, I see someone giving the correct answer. I see some people not giving quite the correct answer. I see more and more correct answers. OK, so let's see. To figure out what type of point it is, we should compute the second partial derivatives. OK, so f sub xx is, what do we get when we take the derivative of this with respect to x? Two over x cubed y. OK, so at our point, a will be two. F sub xy will be one over x squared y squared. So, b will be one. And, f sub yy is going to be one, no, two over xy cubed. So, c will be two. And so, that tells us, well, ac minus b squared is four minus one. Sorry, I should probably use a different blackboard for that. ac minus b squared is two times two minus one squared is three. It's positive. That tells us we are either a local minimum or a local maximum. And, a is positive, so it's a local minimum. And, in fact, you can check it's the global minimum. What about the maximum? Well, the maximum is not actually at a critical point. It's on the boundary or at infinity. So, we have actually to check what happens when x and y go to zero or go to infinity. Well, if that happens, if x or y goes to infinity, then the function goes to infinity. Also, if x or y goes to zero, then one over xy goes to infinity. So, the maximum, well, the function goes to infinity when x goes to infinity, or y goes to infinity, or x and y go to zero. So, it's not at a critical point. So, in general, we have to check both the critical points and the boundaries to decide what happens. OK, the end. Have a nice weekend.