 OK, here's linear algebra, lecture seven. I've been talking about vector spaces and especially the null space of a matrix and the column space of a matrix, what's in those spaces. Now I want to actually describe them. How do you describe all the vectors that are in those spaces? How do you compute these things? So this is the, turning the idea, the definition, into an algorithm. What's the algorithm for solving Ax equals zero? So that's the null space that I'm interested in. So can I take a particular matrix A and describe the natural algorithm and I'll execute it for that matrix? Here we go. So let me take the matrix as an example. So we're definitely talking rectangular matrices in this chapter. So I'll make, I'll have four columns and three rows. Two four six eight and three six eight ten. OK. If I just look at those columns and rows, well, I notice right away that column two is a multiple of column one. It's in the same direction as column one. It's not independent. I'll expect to discover that in the process. Actually, with rows, I notice that that row plus this row gives the third row. So the third row is not independent. So all that should come out of elimination. So now what am I, my algorithm is elimination, but extended now to the rectangular case where we have to continue even if there's zeros in the pivot position, we go on. OK. So let me execute elimination for that matrix. My goal is always, while I'm doing elimination, I'm not changing the null space. That's very important, right? I'm solving Ax equals zero by elimination, and when I do these operations that you already know, when I subtract a multiple of one equation from another equation, I'm not changing the solutions. So I'm not changing the null space. Actually, I am changing the column space, as you'll see. So you have to pay attention. What does elimination leave unchanged? And it, the answer is the solutions to the system are not changed, because I'm doing the same thing to, I'm doing a legitimate operations on the equations. Of course, on the right-hand side, it's always zero, and I don't plan to write zero all the time. OK. So I'm really just working on the left side, but the right side is, is keeping up always zeros. OK. So what's elimination? Well, you know where the first pivot is, and you know what to do with it. So can I just take the first step below here? So that pivot row is fine. I take two times that row away from this one, and I get zero zero, that's signaling a difficulty. Two, two twos away from the six leaves me with a two, two twos away from the eight leaves me with a four, and now three of those away from here is zero, again another zero, three twos away from that eight is the two, three twos away from that ten is a four. OK. That's the first stage of elimination. I've got the first column straight. So, of course, I move on to the second column. I look in that position, I see a zero. I look below it, hoping for a nonzero that I can do a row exchange, but it's zero below. So that's telling me that that column is, well, what it's really going to be telling me is that that column is a combination of the earlier columns, it's depend- that second column is dependent on the earlier column. But I don't stop to think here. That column, there's nothing to do. I go on to the next. So here's the next pivot. So there's the first pivot and there's the second pivot. Can I just keep this elimination going downwards? So, so the next step keeps the first row, keeps the second row with its pivot, so I've got my two pivots and does elimination to clear out the column below that pivot. So actually, you see, the multiplier is one, it subtracts row two from row three and produces a row of zeros. OK. That I would call that matrix U, right? That's our upper, well, I can't quite say upper triangular, maybe upper, I don't know, upper something. It's got, it's in this so-called echelon form. The word echelon means, like, staircase form. It's the non-zeros come in that staircase form. If there was another pivot here, then the staircase would include that. But here's a case where we have two pivots only. OK. So actually, we've already discovered the most important number about this matrix. The number of pivots is two. That number we will call the rank of the matrix. So let me put it, put immediately. The rank of A, so I'm telling you what this word rank means, in the algorithm. It's equal to the number of pivots, and in this case, two. OK. For me, that number two is the crucial number. OK. Now I go to, you remember, I'm always solving Ax equals zero, but now I can solve Ux equals zero, right? Same solutions, same null space. OK. So I could stop here. Why don't I, why don't I stop here and do the back substitution? So now I have to ask you, how do I describe the solutions? There are solutions, right, to Ax equals zero. I knew there would be. I had three equations in four unknowns. I certainly expected some solutions. Now I want to see what are they. OK. Here's the critical step. I, and I refer to it up here as separating out the pivot variables, the pivot columns, which are these two. Here I have two pivot columns. Those are, those, obviously, they're the columns with the pivot. So I have two pivot columns. And I have the other columns I'll call free. Two, these are free columns. OK. Why do I use those words? Why do I use that word free? Because now I want to write, I want to find the solutions to Ux equals zero. Here's the way I do it. These free columns, I can assign any number freely to those, to the variables x2 and x4, the ones that multiply, columns two and four. So I can assign anything I like to x2 and x4. And then I can solve the equations for x1 and x3. Let me say that again. If I give, let me assign. So, so one particular x is to assign, say, the value one to the, to x2 and zero to x4. Those are, that was a free choice, but it's a convenient choice. OK. Now I want to solve Ux equals zero and find numbers one and three, complete the solution. OK. Can I write down, let's see, shall we just remember what Ux equals zero represents? What are my equations? That first equation is x1 plus just, I'm just saying what are these matrices meaning. That's the first equation. And the second equation was two x3 plus four x4 equals zero. Those are my two equations. OK. Now the point is I can find x1 and x3 by back substitution. So we're building on what we already know. The new thing is that there were some free variables that I could give any numbers to. And I'm systematically going to make a choice like this, one and zero. Now what is x3? Let's go backwards. Back up, I look at the last equation. x3 is zero from the last equation. Because x4, we've set x4 to zero and then we get x3 is zero. OK. Now we set x2 to be one, so what is x1? Negative two, right? So that I have negative two plus two, zero and zero, correctly giving zero. There's a vector in the null space. There is a solution to Ax equals zero. In fact, what solution is that? That simply says that minus two times the first column plus one times the second column is the zero column. Of course, that's right. Minus two of that column plus one of that, or minus two of that plus one of that. That solution is that's just what we saw immediately, that the second column is twice as big as the first column. OK. Tell me some more vectors in the null space. I found one. Tell me, how to get a bunch more immediately out of that one. Just take multiples of it. Any multiple of. I could multiply this by anything. I might as well call it, I could say C, some multiple of this. So let me, so x could be any multiple of this one. OK, that, that describes now a line, an infinitely long line in four-dimensional space, but, which is in the null space, is that the whole null space? No. I've got two free variables here. I made this choice, one and zero, for the free variables, but I could have made another choice. Let me make the other choice zero and one. You see my system. So let me repeat the system. This is the algorithm that you, you just learn to do. Find, do, do elimination, decide which are the pivot columns and which are the free columns. That tells you that, that variables one and three are pivot variables, two and four are free variables. Then those free variables, you assign them, you give one of them the value one and the others the value zero. In this case, we had a one and a zero, and complete the solution. And you do, you give the other one the value one and zero, and now complete the solution. So let's complete that solution. I'm looking for a vector in the null space, and it's absolutely going to be different from this guy, because, because any multiple of that zero is never going to give the one. So I have somebody new in the null space, and let me finish it out. What's x3 here? So we're going by back substitution, looking at this equation. Now x4, we've changed, we're doing the other possibility, where x2 is zero and x4 is one. So x3 will happen to be minus two. And now what do I get for that first equation? x1, let's see, two x3s is minus four plus two. Do I get a two there? Perhaps, yeah. Two for x1, minus four and two. OK, that's in the null space. What does that say about the columns? That says that two of this column minus two of this column plus this column gives zero, which it does. Two of that minus two of that and one of that gives the zero column. OK. Now, now I found another vector in the null space, now we're ready to tell me the whole null space. What are all the solutions to Ax equals zero? I've got this guy and when I have him, what else is goes into the null space along with that? These are my two special solutions. I call them special, I just invented that name, special solutions. What's special about them is the special numbers I gave to the free variables. The values zero and one for the free variables. I could have given the free variables any values and got vectors in the null space, but this was a good way to be sure I got everybody. OK, so once I have him, I also have any multiple, right? So I could take any multiple of that and it's in the null space. And now what else, I left a little space for what? What, a plus sign. I can take any combination. Here's a line of vectors in the null space, a bunch of solutions. Would you rather I say in the null space or would you rather I say, OK, I'm solving Ax equals zero? Well, really I'm solving Ux equals zero. Well, OK, let me put in that crucial plus sign. I'm taking all the combinations of my two special solutions. That's my conclusion now. The null space contains exactly all the combinations of the special solutions. And how many special solutions are there? There is one for every free variable. And how many free variables are there? Oh, I mean, we can see all the whole picture now. If the rank r was two, this is the number of pivot variables, right? Because it counted the pivots. So how many free variables? Well, you know it's two, right? What is it in for a matrix that's m rows, n columns, n variables, that means, with rank r? How many free variables have we got left? If r of the variables are pivot variables, we have n-r, in this case, four minus two free variables. Do you see that, first of all, we get a nice we get clean answers here. We get r pivot variables, so there really were r equations here. There looked like three equations, but there were really only two independent equations. And there were n-r variables that we could choose freely, and we gave them those special zero one, uh, values, and we got the special solutions. OK. For me, we could stop at that point. That gives you a complete algorithm for finding all the solutions to Ax equals zero. OK. Again, you do elimination. Going onward, when a column, when there's nothing to be done on one column, you just continue. That this number r, the number of pivots, is crucial, and it leaves n-r free variables, which you give value zero and one to. I would like to take one more step. I would like to clean up this matrix even more. So now I'm going to go to, this is in echelon form. Upper triangular, if you like. I want to go one more step to make it as good as it can be. OK. So now I'm going to speak about the reduced row echelon form. OK, so now I'm going to speak about the matrix R, which is the reduced row echelon form. So what does that mean? That means I just, I can work harder on u. So let me start, let me suppose I got as far as u, which was good. Notice how that row of zeros appeared. I didn't comment on that. But I should have. That row of zeros appeared because row three was a combination of rows one and two. And elimination discovered that fact. When we get a row of zeros, that's telling us that the original row that was there was a combination of other rows and elimination knocked it out. OK, so we got this far. Now how can I clean that up further? I can do, elimination upwards. I can get zero above the pivots. So this reduced row echelon form has zeros above and below the pivots. So let me do that. So now I'll subtract one of this from the row above. That will leave a zero and a minus two in there. And that's good. OK. And I can clean it up even one more step. I can make the pivots, the pivots I'm going to make equal to one. Because I can divide equation two by the pivot. That won't change the solutions. So let me do that. And then I really, I'm ready to stop. One, two, zero, minus two, zero, zero, one, two. I divided the second equation by two, because now I have a one in the pivot and zeros below. OK. This is my matrix R. I guess I'm hoping that you could now execute the whole algorithm. MATLAB will do it immediately with the command RREF, row, reduced row echelon form of A. So if I input that original matrix A, and then I write, then I type that command, press return, that matrix will appear. That's the reduced row echelon form, and it's got all the information as clear as can be. What, what information has it got? Well, of course it immediately tells me the pivot rows, pivot rows, one and two, pivot columns, one and three. And in fact, it's got the identity matrix in there, right? It's got zeros above and below the pivots, and the pivots are one, so it's got a so notice the two by two identity matrix that's sitting in the pivot rows and pivot columns. It's I in the pivot rows and columns. It's got zero rows below. Those are always indicating that original rows were, were combinations of other rows, so we really only had two rows there, and now it also, so there's the identity, now it's also got its free columns, and, they're cleaned up as much as possible. Actually, actually it's now so cleaned up that the special solutions I can read off, you remember I went through the steps of computing this, this, doing back substitution. Let me, let me, instead of that system, let me take this improved system. So I'm going to use these numbers, right? In these equations, what did I do? I divided this equation by two, and oh yeah, and I had subtracted two of this, which knocked out this guy and made that a minus sign. Is that what, that's, that's now, I've now written Rx equals zero. Now, I guess I'm hoping everybody in this room understands. The solutions to the original Ax equals zero, the midway, halfway Ux equals zero, and the final Rx equals zero all the same. Because going from one of those to another one, I didn't mess up. I just multiplied equations and subtracted from other equations, which I'm allowed to do. OK. But my point is that now, if I do this free variables and back substitution, it's just the numbers are there. When I let x, so in this guy, I let x2 be one and x4 be zero. I guess what am I seeing here? Let me, let me sort of separate this out here. I'm seeing in the pivot, in the pivot columns, if I, if I put the pivot columns here, I'm seeing those. And I'm, in the free columns, I'm seeing, what am I seeing in the free columns? A two zero in that first free column, the x2 column, and a minus two two in the, in the, in the fourth column, the other free column. And, and the row of zeros below, which of course have no, if that equation is zero equals zero, that's satisfied. Here's my point. That when I do back substitution, these numbers are exactly what shows up, oh, their signs get switched. I was going to say those numbers, two minus two zero two, can I just circle the, this is the free part of the matrix. This is the identity part. This is the free part. Maybe I'll call it F. This, of course, I call I, because it's the identity. The free part is a, I mean, I'm just doing back substitution. And the free, those free numbers will show up with a minus sign, because they pop onto the other side of the equation, so I see minus two zero and I see two minus two. Can I, so that wasn't magic. It had to happen. Let me, show you clearly why it happened. OK. So that's, this is what I'm interested in here. And now let me, let me just, like, do it, do it for, let's suppose we've, we've got to, let's suppose we've got this system already in, in R, R, E, F form. So my matrix R is, what does it look like? Can I'll, let me pretend that the pivot columns come first and then whatever's in the free come. And there might be some zero rows below. There's a typical, a pretty typical reduced row echelon form. You see what's typical? It's, it's got, this is R by R. This is, this, this is R pivot rows. This is R pivot columns. And here are N-R free columns. OK. Tell me, what are the special solutions? What are the, what's, what's x? If I want to solve Rx equals zero, in fact, let me, I'm really going to, do the whole, since these, this is now block matrices, I might as well do all of the special solutions at once. So I want to solve Rx equals zero. And I'll have some special solutions. Let me, actually, can I do them all at once? I'm going to create a null space matrix. OK. Matrix. Its, its, its columns are the special sol- the columns are the special solutions. This is, I'm making it sound harder. It's going to be totally easy. N will be this null space matrix. I want R N to be the zero matrix. These columns of N are supposed to mul- get multiplied by R and give zero columns. So what N will do the job? Let me put, I'm going to put the identity in the free variable part, and then minus F will show up in the pivot variable, just the way it did in that example. There we had the identity and F. Here, and in the special solution, so these columns are, there's the matrix of special solutions. And actually, so there's a MATLAB command or a teaching code command, null N equal, so this is the, the produces the null basis, the null space matrix, null of A, and there it is. Do you, so I, and how does that command actually work? It uses MATLAB to compute R, then it picks out the pivot variables, the free variables, puts ones and zeros in for the free variables, and copies out the pivot variables. It does back substitution, but back substitution for this system is totally simple. What is this system? R x equals zero. So this is R is I F, and x is the pivot variables and the free variables, and it's supposed to give zero. So what does that mean? That means that the pivot variables plus F times the free variables give zero. So let me put F times the free variables on the other side. I get minus F times the free variables. There's, there's my, equation as simple as it can be. That's, that's what back substitution comes to when I've reduced and reduced and reduced this system to the, to the best form. Okay. And, then if the free variables, I make this special choice of the identity, then the pivot var- pivot variables are minus F. Okay. Can I do, another example? Could you do another example? Can I, let me just take another matrix and, and let's go through this algorithm once more. Okay. Here we go. Here's a blackboard for another matrix. Okay. So I'll call the matrix A again, but let me make it, yeah. How big should we make it this time? Ah, why don't I do this? Just for the heck of it, let me take the transpose of this A and see what happens to that. Two four six eight and three six eight ten. Okay. Before we do the calculations, tell me what's coming. How many pivot variables do you expect here? How many columns are going to have pivots? How many we have three columns in that matrix, but are we going to, are we going to have three pivots? No. Because this third column is the sum of the first two columns. I'm totally expecting, totally expecting that these will be pivot columns, because they're independent, but that this third guy, the third column, which is dependent on the first two, is going to be a free column. Elimination better discover that. And elimination will also straighten out the rows, will also identify some zero, some, some dependent rows and some independent rows. What's the, what's the row-reduce echelon form for this? Let's just do it. Okay. So, so that's the first pivot. Two times that away from that gives me a row of zeros. Two times that away from that gives me a zero, two, two. And two times that away from that gives me a zero, four, four. Okay? First column is straight, first variable is a pivot variable, no problem. On to the second column. I look at the second pivot, it's a zero. I look below it. There's a two. Okay, I do a row exchange. So this zero is now there. I now have a perfectly good pivot and I use it. Okay, and I subtract two of that row away from this row. All right, if I do it like that, I've got to the form u now. This was my a, now there's my u. I can see, I can see now, I have to stop, right? I would go on to the third column. I should have tried. I quit without trying. I shouldn't have done that. On to the third column, look at the pivot position, it's got a zero in it, look below, all zeros, now I'm entitled to stop. Okay. So the rank is two, again. What about the null space? How many special solutions are there this time? How many special solutions for this matrix? I've got, and which are the free variables and which are the pivot variables and so on? Pivot columns, I've got two pivot columns, and that's no accident. The number of pivot columns for a matrix A, that's a great fact, that the number of pivot columns for A and A trans- A transpose are the same. And then I have a free column. There's a free column. One free column, because the count is three minus two. Three minus two gives me one free column. Okay? So now let me solve, what's in the null space? Okay. So how do I, let's see. These vectors have length three, they only have three components. I'm making too much space for the, to write x. x has just got three components, and what are they? I'm looking for the null space. Okay, so how do I start? I give the free variable some convenient value. And what's that? I set it to one. I set the free variable to one. If I set the free variable to zero and solve for the pivot variables, I'll get all zeros, no progress. But by setting the free variable to one, you see my two equations now are, shall I, my equations are x1 plus 2x2 plus 3x3 is zero, that's my first equation. And my second equation is now 2x2 plus 2x3 equals zero. And, okay, so if x3 is one, then x2 is minus one. And if x3 is one and x2 is minus one, then maybe x1 is minus one. And actually, I go back to check now. I don't, like, I did a quick calculation mentally, can I mentally do a quick check? That matrix, that solution x says that minus this column, minus this column plus this one is the zero column. And it is. Minus that, minus that, plus that is zero. So that's in the null space. And now you can tell me what else is in the null space. What's the whole null space now? I multiply by c. Right. The whole null space is a line. So that's the description. If I ask you on a homework or a quiz or the final, what, give me, describe, tell me the null space, find the null space of this matrix, you could take those steps. And that's the answer I'm looking for. And I'm looking for that c, too, because that's telling me that you're remembering that it's a whole space and not just one vector. Later I will ask you for a basis for the null space. Then I just want this vector. But if I ask for the whole null space, then there's the whole line through that vector. OK. Now, one more natural thing to do with this example, right, is keep going to the reduced matrix, R. So can I push onwards to R? That should be quick, but let's just practice. Let me keep going to R. OK. So what do I do here? I subtract, I clear out above the pivot, so I subtract that from that, that's one, zero, one is left. Right? When I subtracted this row from this, it produces zero above this pivot, and now I want that pivot to be a one. So for the R matrix, I'll divide this equation by two, and of course these zero, zeros are great, they don't change. There's R. That's R. You see what R is? You see the identity matrix sitting up here? You see the free part F, the F part here? And you see the zeros below. This is I F zero, zero. And what's the X? The X has the identity, well, it's only a single number one, but it's the identity matrix in the free part, and what does it have in the pivot variables? What did back substitution give? It gave minus these guys. You see that what this is, is any multiple of, this is the identity there, and this is minus F here. This is our null space matrix N, for this. Our null space matrix is the guy whose columns are the special solutions. So their free variables have these special values one, and the pivot variables have minus F. So do you see the, how the minus F just automatically shows up in the special solutions? That's it, really. I don't think there's anything more I can say about A x equals zero. There's more I can say about A x equal b, but that'll be, Friday. OK, so that's the null space. Thanks.