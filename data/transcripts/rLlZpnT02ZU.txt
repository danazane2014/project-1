 The following content is provided under a Creative Commons license. Your support will help MIT OpenCourseWare continue to offer high quality educational resources for free. To make a donation or to view additional materials from hundreds of MIT courses, visit MIT OpenCourseWare at ocw.mit.edu. 124. If I were to repeat this 1,000 times, so every one of those 1,000 times, I collect 124 data points. And then I do it again, and do it again, and again. Then in average, the number I should get should be close to the true parameter that I'm looking for. The fluctuations that are due to the fact that I get different samples every time should somewhat vanish. And so what I want is to have a small bias, hopefully a zero bias. If this thing is zero, then we say that the estimator is unbiased. OK? So this is definitely a property that we're going to be looking for in an estimator, trying to find them to be unbiased. But we'll see that it's actually maybe not enough. So unbiasedness should not be something you lose your sleep over. Something that's slightly better is the risk, so really the quadratic risk, which is expectation of, so if I have an estimator theta hat, I'm going to look at the expectation of theta hat n minus theta squared. And what we showed last time is that we can actually, by inserting in there, adding and removing the expectation of theta hat, we actually get something where this thing can be decomposed as the square of the bias plus the variance, which is just the expectation of theta hat minus its expectation squared. OK, and that came from the fact that when I added and removed the expectation of theta hat in there, the cross-terms canceled. All right, so that was the bias squared. And this is the variance. And so, for example, if the quadratic risk goes to 0, then that means that theta hat converges to theta in the L2 sense. And here, we know that if we want this to go to 0, since it's the sum of two positive terms, we need to have both the bias that goes to 0 and the variance that goes to 0. So we need to control both of those things. And so there is usually an inherent trade-off between getting a small bias and getting a small variance. If you reduce one too much, then the other one is going to increase, or the opposite. That happens a lot, but not so much, actually, in this class. So let's just look at a couple of examples, right? So am I planning on? Yeah, so examples. So if I do, for example, x1, xn that are iid Bernoulli, and I'm going to write it theta so that we keep the same notation, then theta hat, what is the theta hat that we proposed many times? It's just x bar, right? xn bar, the average of the xi's. So what is the bias of this guy? Well, to know the bias, I just have to remove theta from the expectation. What is the expectation of xn bar? Well, by linearity of the expectation, it's just the average of the expectations. But since all my xi's are Bernoulli with the same theta, then each of this guy is actually equal to theta. So this thing is actually theta, which means that this is unbiased, right? Now, what is the variance of this guy? So if you forgot the properties of the variance for some of independent random variables, now it's time to wake up. So we have the variance of something that looks like 1 over n sum from i equal 1 to n of xi, right? So it's of the form variance of a constant times a random variable. So the first thing I'm going to do is pull out the constant. But we know that the variance lives on the square scale. So when I pull out a constant outside of the variance, it comes out with a square, right? The variance of a times x is a squared times the variance of x. So this is equal to 1 over n squared times the variance of the sum. So now, we want to always do what we want to do, right? So we have the variance of the sum. We would like somehow to say that this is the sum of the variances. And in general, we are not allowed to say that. But we are because my xi's are actually independent, right? So this is actually equal to 1 over n squared sum from i equal 1 to n of the variance of each of the xi. And that's by independence. So this is basic probability. And now, what is the variance of xi? Well, again, they're all the same distribution. So the variance of xi is the same as the variance of x1. And so each of those guys has variance what? What is the variance of a Bernoulli? We've said it once. It's theta times 1 minus theta. OK? And so now, I'm going to have the sum of n times a constant. So I get n times the constant divided by n squared. So 1 of the n is going to cancel. And so the whole thing here is actually equal to theta 1 minus theta divided by n. So if I'm interested in the quadratic risk, and again, I should just say risk because this is the only risk we're going to be actually looking at. Yeah, this parenthesis should really stop here. I really wanted to put quadratic in parenthesis. So the risk of this guy is what? Well, it's the expectation of x bar n minus theta squared. And we know it's the square of the variance. So it's the square of the bias, which we know is 0. So it's 0 squared plus the variance, which is theta 1 plus theta 1 minus theta divided by n. OK? So it's just theta 1 minus theta divided by n. So this is just summarizing the performance of an estimator, which is a random variable. I mean, it's complicated. If I really wanted to describe it, I would just tell you the entire distribution of this random variable. But now, what I'm doing is I'm saying, well, let's just take this random variable, remove theta from it, and see how small the fluctuations around theta in squared fluctuations around theta are in expectation. So that's what the quadratic risk is doing. And in a way, this decomposition is the sum of the bias square and the variance is really telling you that it is really accounting for the bias, which is, well, even if I had an infinite amount of observation, is this thing doing the right thing? And the other thing is actually the variance. So for finite number of observations, what are the fluctuations? Then you can see that those things, bias and variance, are actually very different. So I don't have any colors here. So you're going to have to really follow the speed and the order in which I draw those curves. So let's find, I'm going to give you three candidate estimators. So estimators for theta. So the first one is definitely xn bar. That will be a good candidate estimator. The second one is going to be 0.5, because after all, why should I bother if it's actually going to be? So for example, if I ask you to predict the score of some candidate in some election, then since you know it's going to be very close to 0.5, you might as well just throw out 0.5. And you're not going to be very far from reality. And it's actually going to cost you zero time and $0 to come up with this. So sometimes maybe just a good old guess is actually doing the job for you. Of course, for presidential elections or something like this, it's not very helpful if your prediction is telling you this. But if it was something different, that would be a good way to generate some close to 1.5. For a coin, for example, if I give you a coin, you never know. Maybe it's slightly biased. But the good guess, just looking at it, inspecting it, maybe there's something crazy happening with the structure of it, you're going to guess that it's 0.5 without trying to collect information. And let's find another one, which is, well, I have a lot of observations. But I'm recording this couple's kissing. But I am on a budget. I don't have time to travel all around the world and collect some people. So really, I'm just going to look at the first couple and go home. So my other estimator is just going to be x1. I just take the first observation, 0, 1, and that's it. So now I want to actually understand what the behavior of those guys is. So we know that for this guy, the bias is 0. And the variance is equal to theta 1 minus theta divided by n. What is the bias of this guy, 0.5? 0.5 minus theta, right? So the bias, 0.5 minus theta, what is the variance of this guy? What is the variance of 0.5? 0, right? Just a deterministic number. So there's no fluctuations for this guy. What is the bias? Well, x1 is actually, just for simplicity, I can think of it as being x1 bar, the average of itself. So that wherever I saw an n for this guy, I can replace it by 1 and that will give me my formula. So the bias is still going to be 0, and the variance is going to be equal to theta 1 minus theta. So now I have those three estimators. Well, if I compare x1 and xn bar, then clearly I have 0 bias in both cases. That's good. And I have the variance that's actually n times smaller and when I use my n observations than when I don't. So those two guys, on these two fronts, you can actually look at the two numbers and say, well, the first number is the same. The second number is better for the other guy, so I will definitely go for this guy compared to this guy. So this guy is gone. But not this guy. Well, if I look at the bias, the variance is 0. It's always beating the variance of this guy. And if I look at the bias, it's actually really not that bad. It's 0.5 minus theta. In particular, if theta is 0.5, then this guy is strictly better. And so you can actually now look at what the quadratic risk looks like. So here, what I'm going to do is I'm going to take my true theta. So it's going to range between 0 and 1. And we know that those two things are functions of theta. So I can only understand them if I plot them as functions of theta. And so now I'm going to actually plot the y-axis is going to be the risk. So what is the risk of the estimator 0.5? This one is easy. Well, it's 0 plus the square of 0.5 minus theta. So we know that that's theta. It's actually going to be 0. And then it's going to be a square. So at 0, it's going to be 0.25. And at 1, it's going to be 0.25 as well. So it looks like this. Well, actually, let me put the 0.5 where it should be. OK. So this here is the risk of 0.5. I will write it like this. So when theta is very close to 0.5, I'm very happy. When theta gets farther, it's a little bit annoying. And then here, I want to plot the risk of this guy. So another thing with the risk of this guy is that it will depend on n. So I will just pick some n that I'm happy with just so that I can actually draw a line, a curve. Otherwise, I'm going to have to plot one curve for value of n. So let's just say, for example, that n is equal to 10. And so now I need to plot the function theta 1 minus theta divided by 10. We know that theta 1 minus theta is a curve that goes like this. It takes value at 1.5. It takes value 1.25. That's the maximum. And then it's 0 at the end. So really, if n is equal to 1, this is what the variance looks like, right? The bias doesn't count in the risk. Yeah? AUDIENCE MEMBER 2. Can you move the screen? PHILIPPE RIGOLLET. Sure. Can you move the screen? All right. Are you guys good? All right, so now I have this picture. And I know I'm going up to 25. And there's a place where those curves cross. So if you're sure that you're talking about a presidential election, you know that those things are going to be really close, maybe you're actually better by predicting 0.5, if you know it's not going to go too far. But that's for one observation. So that's the risk of x1. But if I look at the risk of xn, all I'm doing is just crushing this curve down to 0. So as n increases, it's going to look more and more like this. The same curve divided by n. OK? And so now I can just start to understand that for different values of thetas, now I'm going to have to be very close to theta is equal to 1 1 if I want to start saying that xn bar is worse than the naive estimator of 0.5. OK? Yeah? AUDIENCE 2 I know you explained a little bit before, but what is an intuitive definition of risk? What is that actually describing? PHILIPPE RIGOLLET What you have an unbiased estimator, it's simple. It's just telling you it's the variance, right? Because the theta that you have over there is really, right? So in the definition of the risk, the theta that you have here, if you're unbiased, is really the expectation of theta hat, right? So that's really just the variance. So the risk is really telling you how much fluctuations I have around my expectation if I'm unbiased, but actually here it's telling you how much fluctuations I have in average around theta. So if you understand the notion of variance as being what? AUDIENCE 2 Is it like variance on average? PHILIPPE RIGOLLET No. It's just like variance. So if you claim you understand what variance is, it's telling you what is the expected squared fluctuation around the expectation of my random variable, right? Just telling you in average how far I'm going to be. And you take the square because you want to cancel the signs, otherwise you're going to get 0. And here it's saying, well, I really don't care what the expectation of theta hat is. What I want to get to is theta. So I'm looking at the expectation of the squared fluctuations around theta itself. If I'm unbiased, they coincide with the variance. But if I'm biased, then I have to account for the fact that I'm really not computing the. AUDIENCE 2 OK. PHILIPPE RIGOLLET OK. All right. Are there any questions? So here, what I really want to illustrate is that the risk itself is a function of theta most of the times. And so for different thetas, some estimators are going to be better than others. But there's also the entire range of estimators, those that are really biased. But the bias can completely vanish. And so here you see you have no bias, but the variance can be large. Or you have a bias, but the variance is 0. So you can actually have this straight off, and you can find things that are in the entire range, in general. OK, so those things are actually, those trade-offs between bias and variance are usually much better illustrated if we're talking about multivariate parameters. If I actually look at a parameter, which is the mean of some multivariate Gaussian, so an entire vector, then the bias is going to, I can make the bias bigger by making, by for example, forcing all the coordinates of my estimator to be the same. So here I'm going to get some bias, but the variance is actually going to be larger because I get to average all the coordinates for this guy. And so really, the bias-variance trade-off is when you have multiple parameters to estimate, say a vector of parameters, a multivariate parameter, is the bias increases when you're trying to pull more information across the different components to actually have a lower variance. So the more you average, the lower the variance. That's exactly what we've illustrated. As n increases, the variance decreases, like 1 over n, or theta 1 minus theta over n. And so this is how it happens in general. In this class, it's mostly one-dimensional parameter estimation, so it's going to be a little harder to illustrate that. But if you do, for example, non-parametric estimation, that's all you do. There's just bias-variance trade-offs all the time. And in between, when you have high-dimensional parametric estimation, that happens a lot as well. OK, so I'm just going to go quickly through those two remaining slides because we've actually seen them. But I just wanted you to have somewhere a formal definition of what a confidence interval is. And so we fixed a statistical model for n observations, x1 to xn. The parameter theta here is one-dimensional. Theta is a subset of the real line, and that's why I talk about intervals, right? An interval is a subset of the line. If I had a subset of R2, for example, that would no longer be called an interval, but a region. Just because, well, that's just, we could say, a set, but a confidence set. But people like to say confidence region. So an interval is just a one-dimensional confidence region, and it has to be an interval as well. So a confidence interval of level 1 minus alpha. So we refer to the quality of a confidence interval is actually called its level. It takes value 1 minus alpha for some positive alpha. And so the confidence level, the level of the confidence interval is between 0 and 1. The closer to 1 it is, the better the confidence interval. The closer to 0, the worse it is. And so for any random interval, so a confidence interval is a random interval. The bounds of this interval depends on random data. Just like we had x bar plus minus 1 over square root of n, for example, or 2 over square root of n. This x bar was the random thing that would make fluctuate those guys. And so now I have an interval, and now I have its boundaries. But now the boundaries are not allowed to depend on my unknown parameter. Otherwise, it's not a confidence interval. Just like an estimator that depends on the unknown parameter is not an estimator. The confidence interval has to be something that I can compute once I collect data. And so what I want is that, so there's this weird notation. The fact that I write theta, that i contains, that's the probability that i contains theta. You're used to seeing theta belongs to i. But here, I really want to emphasize that the randomness is in i. And so the way you actually say it when you read this formula is the probability that i contains theta is at least 1 minus alpha. So it better be close to 1. You want 1 minus alpha to be very close to 1, because it's really telling you that whatever random variable I'm giving you, my error bars are actually covering the right theta. And I want this to be true. But I want this since I don't know what my confidence, my parameter theta is. I want this to hold true for all possible values of the parameters that nature may have come up with for me. So I want this so there's theta that changes here. So the distribution of the interval is actually changing with theta, hopefully. And theta is changing with this guy. So regardless of the value of theta that I'm getting, I want that the probability that it contains the theta is actually larger than 1 minus alpha. So I'll come back to it in a second. I just want to say that here we can talk about asymptotic level. And that's typically when you use central limit theorem to compute this guy. Then you're not guaranteed that the value is at least 1 minus alpha for every n. But it's actually in the limit larger than 1 minus alpha. So maybe for each fixed n, it's going to be not true. But as n goes to infinity, it's actually going to become true. If you want this to hold for every n, you actually need to use things such as Hoeffding's inequality that we described at some point that hold for every n. So as a rule of thumb, if you use the central limit theorem, you're dealing with a confidence interval with asymptotic level 1 minus alpha. And the reason is because you actually want to get some, the quintiles of the Gaussian distribution that comes from the central limit theorem. And if you want to use Hoeffding, for example, you might actually get away with a confidence interval that's actually true, even non-asymptotically, just the regular confidence interval. So this is the formal definition. It's a bit of a mouthful. But we actually, the best way to understand them is to build them. Now, at some point I said, and I think it was part of the homework, so here I really say the probability that the true parameter belongs to the confidence interval is actually 1 minus alpha. And so that's because here, this confidence interval is still a random variable. Now, if I start plugging in numbers, instead of the random variables, x1 to xn, I start putting 1, 0, 0, 1, 0, 0, 0, 1, like I did for the kiss example, then in this case, the random interval is actually going to be 0.42, 0.65. And this guy, the probability that theta belongs to it is not 1 minus alpha. It's either 0 if it's not in there, or it's 1 if it's in there. OK? So here is the example that we had. So just let's look back at our favorite example, which is the average of Bernoulli random variables. So we studied that maybe that's the third time already. So the sample average, xn bar, is a strongly consistent estimator of p. That was one of the properties that we wanted. Strongly consistent means that as n goes to infinity, it converges almost surely to the true parameter. That's the strong law of large number. It is consistent also, because it's strongly consistent. So it also converges in probability, which makes it consistent. It's unbiased. We've seen that. We've actually computed its quadratic risk. And now what I have is that if I look at, thanks to the central limit theorem, we actually did this. We built a confidence interval at level 1 minus alpha, right? Asymptotic level, sorry, asymptotic level 1 minus alpha. And so here, this is how we did it. Let me just go through it again. So we know from the central limit theorem. So the central limit theorem tells us that xn bar minus p divided by square root of p1 minus p square root of n converges in distribution as n goes to infinity to some standard normal distribution. So what it means is that if I look at the probability under the true p, that square root of n xn bar minus p divided by square root of p1 minus p is less than q alpha over 2, where this is the definition of the quintile, then this guy, and I'm actually going to use the same notation, limit as n goes to infinity. This is the same thing, right? So this is actually going to be equal to 1 minus alpha. That's exactly what I did last time. This is by definition of the quintile of a standard Gaussian and of limiting distribution. So the probabilities computed on this guy in the limit converges to the probability computed on this guy. And we know that this is just the probability that the absolute value of some n0,1 is less than q alpha over 2. And so in particular, if it's equal, then I can put some larger than or equal to, which guarantees my asymptotic confidence level. And I just solve for p. So this is equivalent to the limit as n goes to infinity of the probability that theta is between xn bar minus q alpha over 2 divided by times square root of p1 minus p divided by square root of n xn bar plus q alpha over 2 square root of p1 minus p divided by square root of n is larger than or equal to 1 minus alpha. And so there you go. I have my confidence interval, except that's not, right? We just said that the bounds of a confidence interval may not depend on the unknown parameter. And here they do. And so we actually came up with two ways of getting rid of this. Since we only need this thing, so this thing, as we said, is really equal, every time I'm going to make this guy smaller and this guy larger, I'm only going to increase the probability. And so what we do is we actually just take the largest possible value for p1 minus p, which makes the interval as large as possible. And so now I have this. I just do one of the two tricks. I replace p1 minus p by their upper bound, which is 1 quarter. As we said, p1 minus p, the function looks like this. So I just take the value here at 1 half. Or I can use Slutsky and say that if I replace p by xn bar, it's the same as just replacing p by xn bar here. And by Slutsky, we know that this is actually converging also to some standard Gaussian. We've seen that when we saw Slutsky as an example. And so those two things actually, just because I'm taking the limit and I'm only caring about the asymptotic confidence level, I can actually just plug in consistent quantities in there, such as xn bar where I don't have a p. And that gives me another confidence interval. So this, by now, hopefully, after doing it three times, you should really, really be comfortable with just creating this confidence interval. We did it three times in class. I think you probably did it another couple times in your homework. So just make sure you're comfortable with this. That's one of the basic things you would want to know. Are there any questions? Yes? So Slutsky holds for any continuous function p, but xn converges to that distribution that p doesn't have any relation to p. So that's not Slutsky, right? Slutsky tells you that if you Slutsky is about combining two types of convergence. So Slutsky tells you that if you actually have one xn that converges to x in distribution and yn that converges to y in probability, then you can actually multiply xn and yn and get that the limit in distribution is the product of x and y, where x is now a constant. And here we have the constant, which is 1. But I did that already, right? Using Slutsky to replace p by xn bar, we've done that last time, maybe a couple times ago, actually. Yeah? So it's like these stations are not true in the real time, right? That's correct. So could we figure out for when we're set up by the, when we're looking for phi, that we set up phi at n? Are there any sources between that? So of course, the short answer is no. So here's how you would go about thinking about which method is better, right? So there's always the more conservative method. The first one, the only thing you're losing is the rate of convergence of the central limit theorem. So if n is large enough so that the central limit theorem approximation is very good, then that's all you're going to be losing, right? Of course, the price to pay is that your confidence interval is wider than it would be if you were to use Slutsky for this particular problem, typically wider. Actually, it is always wider. And so because 1 minus xn bar is always less than 1 quarter as well. And so that's the first thing. So Slutsky basically adds you're relying on the central limit. You're relying on the asymptotics again. Now, of course, you don't want to be conservative, because you actually want to squeeze as much from your data as you can, right? So it depends on how comfortable and how critical it is for you to put valid error bars, right? If they're valid in the asymptotics, then maybe you're actually going to go with Slutsky. So it actually gives you slightly narrower confidence intervals. And so you feel like you have a more precise answer. Now, if you really need to be super conservative, then you're actually going to go with the p1 minus p. Actually, if you need to be even more conservative, you are going to go with Hoeffding. So you don't even have to rely on the asymptotic level at all. But then your confidence interval becomes twice as wide and twice as wide. And it becomes wider and wider as you go, right? So it depends on the, I mean, there's a lot of that in statistics, which is gauging how critical it is for you to output valid error bounds, or if they're really just here to be indicative of the precision of the estimator that you gave from a more qualitative perspective. So the error is basically a bunch of errors? Yeah, so here there's basically a bunch of errors. There's one that's, so there's a theorem called Baryesian that quantifies how far this probability is from 1 minus alpha. But the constants are terrible. So it's not very helpful. But it tells you as n grows, how smaller this thing becomes smaller. And then for Slutsky, again, you're multiplying something that converges by something that fluctuates around 1. So you need to understand how this thing fluctuates. Now, there's something that shows up is basically, what is the slope of the function 1 over square root of x 1 minus x around the value you're interested in? And so if this function is super sharp, then small fluctuations of xn bar around its expectation are going to lead to really high fluctuations of the function itself, right? So if you're looking at, if you have f of xn bar, and f around, say, the true p, if f is really sharp like that, then if you move a little bit here, then you're going to move really a lot on the y-axis. So that's what the function here, the function you're interested in is 1 over square root of x 1 minus x, right? So what does this function look like around the point where you think p is the true parameter? It's derivative, really, is what matters. OK? Any other question? OK, so it's important, because now we're going to switch to the real, let's do some hardcore computation type of thing. All right. So in this chapter, we're going to talk about maximum likelihood estimation. Who has already seen maximum likelihood estimation? OK? And who knows what a convex function is? OK. So we'll do a little bit of reminders on those things. So those things are, when we do maximum likelihood estimation, the likelihood is a function, so we need to maximize a function. That's basically what we need to do. And if I give you a function, you need to know how to maximize this function. Sometimes you have closed form solutions, or you can take the derivative and set it equal to 0 and solve it. But sometimes you actually need to resort to algorithms to do that. And there's an entire industry doing that. And we'll briefly touch upon it, but this is definitely not the focus of this class. OK, so before diving directly into the definition of the likelihood and what is the definition of the maximum likelihood estimator, what I'm going to try to do is to give you an insight for what we're actually doing when we do maximum likelihood estimation. OK? So remember, we have a model on a sample space, E, and some candidate distributions, p theta. And really, your goal is to estimate a true theta star, the one that generated some data, x1 to xn, in an iid fashion. But this theta star is really a proxy for us to know that we actually understand the distribution itself. The goal of knowing theta star is so that you can actually know what p theta star is. Otherwise, it has, well, sometimes we said it has some meaning itself. But really, you want to know what the distribution is. And so your goal is to actually come up with a distribution, hopefully that comes from the family p theta, that's close to p theta star. OK, so in a way, what does it mean to have two distributions that are close? It means that when you compute probabilities on one distribution, you should have the same probability on the other distribution, pretty much. So what we can do is say, well, now I have two candidate distributions. So theta hat leads to a candidate distribution, p theta hat. And this is the true theta star that leads to the true distribution, p theta star, according to which my data was drawn. So that's my candidate. As a statistician, I'm supposed to come up with a good candidate. And this is the truth. And what I want is that if you actually give me the distribution, then when I'm computing probabilities for this guy, I know what the probabilities for the other guys are. And so really, what I want is that if I compute, say, probability under theta hat of some interval, a, b, it should be pretty close to the probability under theta star of a, b. And more generally, if I want to take the union of two intervals, I want this to be true. If I take just half lines, I want this to be true from 0 to infinity, for example, things like this. I want this to be true for all of them at once. And so what I do is that I write a for a probability event. And I want that p hat of a is close to p star of a for any event a in the sample space. Does that sound like a reasonable goal for a statistician? So in particular, if I want those to be close, I want the absolute value of their difference to be close to 0. And this turns out to be, if I want this to hold for all possible a's, I have all possible events. So I'm going to actually maximize over these events. And I'm going to look at the worst possible event on which theta hat can depart from theta star. And so rather than defining it specifically for theta hat and theta star, I'm just going to say, well, if you give me two probability measures, p theta and p theta prime, I want to know how close they are. Well, if I want to measure how close they are by how they can differ when I measure the probability of some event, I'm just looking at the absolute value of the difference of the probabilities. And I'm just maximizing over the worst possible event that might actually make them differ. Agreed? That's a pretty strong notion. So if the total variation between theta and theta prime is small, then it means that for all possible a's that you give me, then p theta of a is going to be close to p theta prime of a. So because if, let's say, I just found a bound on the total variation distance, which is 0.01, so that means that this is going to be larger than the max over a of p theta minus p theta prime of a, which means that for any a, actually, let me write p theta hat and p theta star like we said, theta hat and theta star. And so if I have a bound, say, on the total variation, which is 0.01, that means that p theta hat, every time I compute a probability on p theta hat, it's basically in the interval p theta star of a, the one that I really wanted to compute, plus or minus 0.01. This has nothing to do with confidence interval. It's just telling me how far I am from the value I'm actually trying to compute. And that's true for all a. And that's key. That's where this max comes into play. It just says I want this bound to hold for all possible a's at once. So this is actually a very well-known distance between probability measures. It's the total variation distance. It's extremely central into probabilistic analysis. And it essentially tells you that every time, if two probability distributions are close, then it means that every time I compute a probability under p theta, but I really actually have data from p theta prime, then the error is no larger than the total variation. So this is maybe not the most convenient way of defining a distance. I mean, in reality, how are you going to compute this maximum over all possible events? I mean, it's just crazy. There's an infinite number of them. It's much larger than the number of intervals, for example. So it's a bit annoying. And so there's actually a way to compress it by just looking at the basically function distance or vector distance between probability mass functions or probability density functions. So I'm going to start with the discrete version of the total variation. So throughout this chapter, I will make the difference between discrete random variables and continuous random variables. It really doesn't matter. All it means is that when I talk about discrete, I will talk about probability mass functions. And when I talk about continuous, I will talk about probability density functions. When I talk about probability mass functions, I talk about sums. And when I talk about probability density functions, I talk about integrals. But they're all the same thing, really. So let's start with the probability mass function. Everybody remembers what the probability mass function of a discrete random variable is? This is the function that tells me for each possible value that it can take, the probability that it takes this value. So the probability mass function PMF is just the function for all x in the sample space tells me the probability that my random variable is equal to this little value. And I will denote it by p sub theta of x. So what I want is, of course, that the sum of the probabilities is 1. And I want them to be non-negative. Actually, typically, we will assume that they're positive. Otherwise, we can just remove this x from the sample space. And so then I have the total variation distance. I mean, it's supposed to be the maximum over all sets of subsets of E such that the probability of theta of A minus probability of theta prime of A, it's complicated. But really, there's this beautiful formula that tells me that if I look at the total variation between p theta and p theta prime, it's actually equal to just 1 half of the sum for all x and E of the absolute difference between p theta x and p theta prime of x. So that's something you can compute. If I give you two probability mass functions, you can compute this immediately. But if I give you just the densities and the original definition where you have to max over all possible events, it's not clear you're going to be able to do that very quickly. So this is really the one you can work with. But the other one is really telling you what it's doing for you. It's controlling the difference of probabilities you can compute on any event. But here, it's just telling you, well, if you do it for each simple event, little x, it's actually simple. Now, if we have continuous random variables, right? So by the way, I didn't mention, but discrete means Bernoulli binomial. But not only those that have finite support, like Bernoulli as support of size 2, binomial np as support of size n. There's n possible values it can take, but also Poisson. Poisson distribution can take an infinite number of values, all the positive integers, non-negative integers. And so now, we have also the continuous ones, such as Gaussian, exponential. And what characterizes those guys is that they have a probability density. So the density, remember, the way I use my density is when I want to compute the probability of belonging to some event A, the probability that x fall into some subset of the real line A, is simply the integral of the density on this set. That's the famous area under the curve thing. So since for each possible value, the probability at x, so I hope you remember that stuff. That's just probably something that you must remember from probability. But essentially, we know that the probability at x is equal to little x is 0 for a continuous random variable for all possible x's. There's just none of them that actually gets weight. So what we have to do is to describe the fact that it's in some little region. So the probability that it's in some interval, say, AB, this is the integral between A and B of f theta of x dx. So I have this density, such as the Gaussian one. And the probability that I belong to the interval AB is just the area under the curve between A and B. If you don't remember that, please take immediate remedy. So this function f, just like p, is non-negative. And rather than summing to 1, it integrates to 1 when I integrate over the entire sample space E. And now the total variation, well, it takes basically the same form. I said that you essentially replace sums by integrals when you're dealing with densities. And here, it's just saying, rather than having half of the sum of the absolute values, you have half of the integral of the absolute value of the difference. Again, if I give you two densities, and if you're not too bad at calculus, which you will often be, because there's lots of them you can actually not compute. But if I give you, for example, two Gaussian densities, exponential minus x squared, blah, blah, blah, and I say, just compute the total variation distance, you could actually write it as an integral. Now, whether you can actually reduce this integral to some particular number is another story. But you could technically do it. And so now, you have actually a handle on this thing. And you could technically ask Mathematica, whereas asking Mathematica to take the max over all possible events is going to be difficult. So the total variation has some properties. Just so let's keep on the board the definition that involves, say, the densities. So think Gaussian in your mind. And you have two Gaussians, one with mean theta and one with mean theta prime. And I'm looking at the total variation between those two guys. So if I look at p theta minus, sorry, Tv between p theta and p theta prime, this is equal to 1 half of the integral between f theta, f theta prime. And when I don't write it, so I don't write x dx, but it's there, and then I integrate over e. So what is this thing doing for me? It's just saying, well, if I have, so think of two Gaussians, for example. I have one that's here and one that's here. So this is, let's say, f theta, f theta prime. This guy is doing what? It's computing the absolute value of the difference between f theta and f theta prime. So you can check for yourself that graphically, this I can represent as an area not under the curve, but between the curves. So this is this guy. Now, this guy is really the integral of the absolute value. So this thing here, this area, this is 2 times the total variation. This scaling 1 half really doesn't matter. It's just if I want to have an actual correspondence between the maximum and the other guy, I have to do this. So this is what it looks like. So we have this definition. And so we have a couple of properties that come into this. The first one is that it's symmetric. Tv of p theta and p theta prime is the same as the Tv between p theta prime and p theta. Well, that's pretty obvious from this definition, right? I just flip those two, I get the same number. It's actually also true if I take the maximum. Those things are completely symmetric in theta and theta prime. You can just flip them. It's non-negative. Is that clear to everyone that this thing is non-negative? I integrate an absolute value. So this thing is going to give me some non-negative number. And so if I integrate this non-negative number, it's going to be a non-negative number. The fact also that it's an area tells me that it's going to be non-negative. The nice thing is that if Tv is equal to 0, then the two distributions, the two probabilities, are the same. That means that for every a, p theta of a is equal to p theta prime of a. Now, there's two ways to see that. The first one is to say that if this integral is equal to 0, that means that for almost all x, f theta is equal to f theta prime. The only way I can integrate a non-negative function and get 0 is that it fits 0 pretty much everywhere. And so what it means is that the two densities have to be the same pretty much everywhere, which means that the distributions are the same. But this is not really the way you want to do this, because you have to understand what pretty much everywhere means, which I should really say almost everywhere. That's the formal way of saying it. But let's go to this definition, which is gone. Yeah, that's the one here. The max of those two guys. If this maximum is equal to 0, I have a maximum of non-negative numbers. They're absolute values. Their maximum is equal to 0. Well, they better be all equal to 0, because if 1 is not equal to 0, then the maximum is not equal to 0. So those two guys, for those two things, to be for the maximum to be equal to 0, then each of the individual absolute values have to be equal to 0, which means that the probability here is equal to this probability here for every event A. So those two things, this is nice. That's called definiteness. The total variation equal to 0 implies that p theta is equal to p theta prime. So that's really some notion of distance. That's what we want. If this thing's being small implied that p theta could be all over the place compared to p theta prime, that would not help very much. Now, there's also the triangle inequality that follows immediately from the triangle inequality inside this guy. If I squeeze in some f theta prime prime in there, I'm going to use the triangle inequality and get the triangle inequality for the whole thing. OK? Yeah? AUDIENCE 2 The fact that these two definitions of the total variation distance is equivalent, is it something obvious, or is it something new? PHILIPPE RIGOLLET I'll do it for you now. So let's just prove that those two things are actually giving me the same definition. So what I'm going to do is I'm actually going to start with the second one. And I'm going to start with the density version, but as an exercise, you can do it for the PMF version if you prefer. So I'm going to start with the fact that f. OK? So I'm going to write f of g so I don't have to write f and g. So think of this as being f sub theta, and think of this guy as being f sub theta prime. I just don't want to have to write indices all the time. So I'm going to start with this thing, the integral of f of x minus g of x dx. The first thing I'm going to do is this is an absolute value. So either the number in the absolute value is positive, and I actually kept it like that, or it's negative and I flipped it sign. So let's just split between those two cases. So this thing is equal to 1 half the integral of, so let me actually write the set A star as being the set of x's such that f of x is larger than g of x. So that's the set on which the difference is going to be positive or the difference is going to be negative. So this, again, is equivalent to f of x minus g of x is positive. All right? OK, everybody agrees? So this is the set I'm interested in. So now I'm going to split my integral into two parts, in A, A star. So on A star, f is larger than g, so the absolute value is just the difference itself. So here I put parentheses rather than absolute value. And then I have plus 1 half of the integral on the complement. What are you guys used to to write the complement? To the c or the bar? To the c? OK, and so here on the complement, then f is less than g, so this is actually really g of x minus f of x dx. OK, everybody's with me here? So I just said, I mean, those are just rewriting what the definition of the absolute value is. OK, so now there's nice things that I know about f and g. And the two nice things is that the integral of f is equal to 1 and the integral of g is equal to 1. This implies that the integral of f minus g is equal to what? 0. OK, and so now that means that if I want to just go from the integral here on A complement to the integral on A or on A star complement to the integral on A star, I just have to flip the sign. So that implies that the integral on A star complement of g of x minus f of x dx, this is simply equal to the integral on A star of f of x minus g of x dx. All right, so now this guy becomes this guy over there. So I have 1 half of this plus 1 half of the same guy. So that means that 1 half of the integral of f minus g absolute value, so that was my original definition, this thing is actually equal to the integral on A star of f of x minus g of x dx. And this is simply equal to p of A star, so say pf of A star minus pg of A star. OK, which one is larger than the other one? It is. Just look at this board. What? The first one has to be larger because this thing is actually equal to a non-negative number. OK? So now I have this absolute value of two things. And so I'm closer to the actual definition, but I still need to show you that this thing is the maximum value, right? So this is definitely, at most, the maximum over A of pf of A minus pg of A. That's certainly true, right? We agree with this? Because this is just for one specific A, and I'm bounding it by the maximum over all possible A's. So that's clearly true. So now I have to go the other way around. I have to show you that the max is actually this guy, A star. So why would that be true? Well, let's just inspect this thing over there. So we want to show that if I take any other A in this integral, then this guy, A star, it's actually going to decrease its value. So we have this function. I'm going to call this function delta. And what we have is, so let's say this function looks like this. Now, it's the difference between two densities. It doesn't have to be non-negative, but it certainly has to integrate to 0. And so now I take this thing. And the A star, what is the set A star here? The set A star is the set over which the function delta is non-negative. So that's just the definition. A star was the set over which f minus g was positive, and f minus g was just called delta. So what it means is that what I'm really integrating is delta on this set. So it's this area under the curve, just on the positive things. Agreed? So now, let's just make some tiny variations around this guy. If I take A to be larger than A star, so let me add, for example, this part here. That means that when I compute my integral, I'm removing this area under the curve. It's negative. The integral here is negative. So if I start adding something to A, the value goes lower. If I start removing something from A, like say this guy, I'm actually removing this value from the integral. So there's no way. I'm actually stuck. This A star is the one that actually maximizes the integral of this function. So we use the fact that for any function, say delta, the integral over A of delta is less than the integral over the set of x's such that delta of x is non-negative of delta of x dx. And that's an obvious fact, just by picture, say. And that's true for all A. Yeah? AUDIENCE 1 It's actually equal. We know that the integral of f minus g, the integral of delta is 0. So there's actually exactly the same area above and below. Yeah, you're right. You could go to the extreme cases. You're right. No, it's actually still be true. Even if this was a constant, that would still be true. Here, I never use the fact that the integral is equal to 0. I could shift this function by 1 so that the integral of delta is equal to 1. And it would still be true that it's maximized when I take A to be the set where it's positive. Just need to make sure that there's some place where it is. But that's about it. Of course, we used this before when we made this thing. But just the last argument, this last fact, does not require that. All right, so now we have this notion of distance between probability measures. I mean, these things are exactly what if I were to be in a formal math class, and I said, here are the axioms that a distance should satisfy. Those are exactly these things. If it's not satisfying this thing, it's called pseudo-distance or quasi-distance or just metric or nothing at all, honestly. So it's a distance. It's symmetric, non-negative, equal to 0 if and only if the two arguments are equal, and it satisfies the triangle inequality. And so that means that we have this actual total variation distance between probability distributions. And here is now a statistical strategy to implement our goal. Remember, our goal was to spit out a theta hat, which was close, such that p theta hat was close to p theta star. So hopefully, we're trying to minimize the total variation distance between p theta hat and p theta star. Now, we cannot do that, because just by this fact, this slide, if we wanted to do that directly, we would just take, well, let's take theta hat equals theta star, and that will give me the value 0, and that's the minimum possible value we can take. The problem is that we don't know what the total variation is to something that we don't know. We know how to compute total variations if I give you the two arguments. But here, one of the arguments is not known. p theta star is not known to us. So we need to estimate it. And so here is a strategy. Just build an estimator of the total variation distance between p theta and p theta star for all candidate theta, all possible theta and capital theta. Now, if this is a good estimate, then when I minimize it, I should get something that's close to p theta star. So here's the strategy. This is my function that maps theta to the total variation between p theta and p theta star. I know it's minimized at theta star. That's definitely p theta, Tv of p, and the value here, the y-axis, should say 0. And so I don't know this guy, so I'm going to estimate it by some estimator that comes from my data. Hopefully, the more data I have, the better this estimator is. And I'm going to try to minimize this estimator now. And if the two things are close, then the minima should be close. That's a pretty good estimation strategy. The problem is that it's very unclear how you would build this estimator of the total variation. So building estimators, as I said, typically consists in replacing expectations by averages. But there's no simple way of expressing the total variation distance as the expectation with respect to theta star of anything. So what we're going to do is we're going to move from total variation distance to another notion of distance that sort of has the same properties and the same feeling and the same motivations as the total variation distance. But for this guy, we will be able to build an estimate for it, because it's actually going to be of the form expectation of something. And we're going to be able to replace the expectation by an average and then minimize this average. All right? So this surrogate for total variation distance is actually called the Kalbach-Leibler divergence. And why we call it divergence is because it's actually not a distance. It's not going to be symmetric to start with. So this Kalbach-Leibler, or even KL divergence, I will just refer to it as KL, is actually just more convenient. But it has some roots coming from information theory, which I will not delve into. But if any of you is actually a course 6 student, I'm sure you've seen that in some course that has any content on information theory. So the KL divergence between two probability measures, p theta and p theta prime. And here, as I said, it's not going to be symmetric. So it's very important for you to specify which order you say, between p theta and p theta prime. And it's different from saying between p theta prime and p theta. And so we denote it by KL. So remember, before we had either the sum or the integral of 1 half of the distance, absolute value of the distance between the PMFs, and 1 half of the absolute values of the distances between the parabolic density functions. And now we replace this absolute value of the distance divided by 2 by this weird function. This function is p theta log p theta divided by p theta prime. That's the function. That's a weird function. So this was what we had. So that's the TD. And the KL, if I use the same notation, f and g, is integral of f of x log of f of x over g of x dx. It's a bit different. And I go from discrete to continuous using an integral. Everybody can read this. Everybody's fine with this. Is there any uncertainty about the actual definition here? So here, I go straight to the definition, which is just plug in the functions into some integral and compute. So I don't bother with maxima or anything. There is something like that, but it's certainly not as natural as the tool variation. Yes? AUDIENCE 2 The tool variation, do you think you can do anything with it like that? Because you can build up KL a lot, but then it's not. Yeah, it's just because it's hard to build anything from tool variation, because I don't know it. So it's very difficult. But if you can actually, and even computing it between two Gaussians, just try it for yourself. And please stop doing it after at most six minutes, because you won't be able to do it. And so it's just very hard to manipulate. Like this integral of absolute values of differences between probability density functions, at least for the probability density functions we're used to manipulate, is actually a nightmare. And so people prefer KL, because for the Gaussian, this is going to be theta minus theta prime squared. And then we're going to be happy. And so those things are much easier to manipulate. But it's really the tool variation is telling you how far, in the worst case, the two probabilities can be. This is really the intrinsic notion of closeness between probabilities. So that's really the one, if we could, that's the one we would go after. Sometimes people will compute them numerically so that they can say, oh, here's the tool variation distance I have between those two things. And then you actually know that that means they're close. Because the absolute value, if I tell you tool variation is 0.01 like we did here, it has a very specific meaning. If I tell you the KL divergence is 0.01, it's not clear what it means. So what are the properties? The KL divergence between p theta and p theta prime is different from the KL divergence between p theta prime and p theta in general. Of course, in general, because if theta is equal to theta prime, then this certainly is true. So there's cases when it's not true. The KL divergence is non-negative. Who knows the Jensen's inequality here? That should be a subset of the people who have raised their hand when I asked what a convex function is. So you know what Jensen's inequality is? The proof is just one step Jensen's inequality, which we will not go into details. But that's basically an inequality involving expectation of a convex function of a random variable compared to the convex function of the expectation of a random variable. If you know Jensen, have fun and prove it. What's really nice is that if the KL is equal to 0, then the two distributions are the same. And that's something we're looking for. Everything else we're happy to throw out. And actually, if you pay attention, we're actually really throwing out everything else. So they're not symmetric. It does not satisfy the triangle inequality in general. But it's non-negative, and it's 0 if and only if the two distributions are the same. And that's all we care about. And that's what we call a divergence rather than a distance. And divergences will be enough for our purposes. Actually, this asymmetry, the fact that it's not flipping, the first time I saw it, I was just annoyed. Can we just take the average of the KL between p theta and p theta prime and p theta prime and p theta? You would think maybe you could do this. You just symmetrize it by just taking the average of the two possible values it can take. The problem is that this will still not satisfy the triangle inequality. And there's no way, basically, to turn it into something that is a distance. But the divergence is doing a pretty good thing for us. And this is what will allow us to estimate it and basically overcome what we could not do with the total variation. So the first thing that you want to notice is that the KL divergence is actually an expectation of something. Look at what it is here. It's the integral of some function against a density. That's exactly the definition of an expectation. So this is the expectation of this particular function with respect to this density f. So in particular, if I call this density f, if I say I want the true distribution to be the first argument, this is an expectation with respect to the true distribution from which my data is actually drawn of the log of this ratio. So ha-ha, I'm a statistician. Now I have an expectation. I can replace it by an average because I have data from this distribution. And I could actually replace the expectation by an average and try to minimize here. The problem is that, actually, the star here should be in front of the theta, not of the p. That's p theta star, not p star theta. But here I still cannot compute it because I have this p theta star that shows up. I don't know what it is. And that's now where the log plays a role. If you actually pay attention, I said you can use Jensen to prove all this stuff. You could actually replace the log by any concave function. That would be f divergence. That's called an f divergence. But the log itself is a very, very specific property which allows us to say that the log of the ratio is the ratio of the logs. Now this thing here does not depend on theta. If I think of this KL divergence as a function of theta, then the first part is actually a constant. If I change theta, this thing is never going to change. It depends only on theta star. So if I look at this function KL, so if I look at the function theta maps to KL p theta star p theta, it's of the form expectation with respect to theta star log of p theta star of x. And then I have minus expectation with respect to theta star of log of p theta of x. Now as I said, this thing here, this second expectation is a function of theta. When theta changes, this thing is going to change. And that's a good thing. We want something that reflects how close theta and theta star are. But this thing is not going to change. This is a fixed value. It's actually the negative entropy of p theta star. And if you've heard of KL, you've probably heard of entropy. And that's what the basically minus the entropy. And that's a quantity that just depends on theta star, but it's just a number. I could compute this number if I told you this is n theta star 1. You could compute this. So now I'm going to try to minimize the estimate of this function. And minimizing a function or a function plus a constant is the same thing. I'm just shifting the function here or here, but it's the same minimizer. So the function that maps theta to KL of p theta star p theta is of the form constant minus this expectation of a log of p theta. Everybody agrees? Are there any questions about this? Are there any remarks, including I have no idea what's happening right now? OK, you good? Yeah? So when you're actually employing this method, how do you know which theta p is a theta star and which isn't? So this is not a method just yet. I'm just describing to you what the KL divergence between two distributions is. If you really wanted to compute it, you would need to know what p theta star is and what p theta is. And so here I'm just saying at some point we still, so here you see it. So now let's move on to one step. I don't know expectation of theta star, but I have data that comes from distribution p theta star. So the expectation by the law of large numbers should be close to the average. And so what I'm doing is I'm replacing any, I can actually, this is a very standard estimation method. You write something as an expectation with respect to the data generating process of some function, and then you replace this by the average of this function. And the law of large number tells me that those two quantities should actually be close. Now, it doesn't mean that's going to be the end of the day, right? When we did the xn bar, that was the end of the day. We had an expectation, we replaced it by an average, and then we were gone. But here we still have to do something, because this is not telling me what theta is. Now I still have to minimize this average. So this is now my candidate estimator for KL, KL hat. And that's the one where I said, well, it's going to be of the form of constant. And this constant, I don't know. You're right. I have no idea what this constant is. It depends on p theta star. But then I have minus something that I can completely compute. If you give me theta and theta, I can compute this entire thing. And now what I claim is that the minimizer of f or f plus 4, f of x or f of x plus 4 are the same thing, right? Or say 4 plus f of x. I'm just shifting the plot of my function up and down, but the minimizer stays exactly where it is. If I have a function, so now I have a function of theta. This is KL hat of p theta star p theta. And it's of the form, it's a function like this. I don't know where this function is. It might very well be this function or this function. Every time it's a translation on the y-axis of all these guys, and the value that I translate it by depends on theta star, I don't know what it is. But what I claim is that the minimizer is always this guy, regardless of what the value is. So when I say constant, it's a constant with respect to theta. It's an unknown constant, but it's with respect to theta. So without loss of generality, I can assume that this constant is 0 for my purposes, or 25 if you prefer. All right, so we'll just keep going on this property next time. And we'll see how from here we can move on to the likelihood is actually going to come out of this formula. Thanks.