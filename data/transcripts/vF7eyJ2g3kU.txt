 Five four. Okay. This is the lecture on positive definite matrices. I made a start on those briefly in a previous lecture, and one point I wanted to make was the way that this topic brings the whole course together, pivots, determinants, eigenvalues, and something new for po- and stability, and then something new in this expression x transpose Ax. Actually, that's the guy to watch in this lecture. So, so the topic is positive definite matrix, and what's my goal? First, first goal is how can I tell if a matrix is positive definite? So I would like to have tests to see if you give me a five by five matrix, how do I tell if it's positive definite? More important is what does it mean? Why are we so interested in this property of positive definiteness? And then at the end comes some geometry. Ellipses are connected with positive definite things. Hyperbolas are not connected with positive definite things. So we, it's this, there's a geometry too, but mostly it's linear algebra, and this, this application of how do you recognize when you have a minimum is pretty neat. Okay. I'm going to begin with two by two. All matrices are symmetric, right? That's understood. The matrix is symmetric. Now my question is, is it positive definite? Now here are some, each one of these is a complete test for positive definiteness. If I know the eigenvalues, my test is, are they positive? Are they all positive? If I know the, these, so A is really, I, I look at that number A here as the, as the one by one determinant, and here's the two by two determinant. So the, this is the determinant test. This is the eigenvalue test, this is the determinant test. Are the determinants growing in, of all, of all n, sort of, could I call them leading submatrices? They're, they're, they're the first ones, they're the Northwest Seattle submatrices coming down from, from there. They all, all those determinants have to be positive. And then another test is the pivots. The pivots of a two by two matrix are that number A, for sure. And, since the product is the determinant, the second pivot must be the determinant divided by A. And then in here is going to come my favorite and my new idea, the, the, the, the one to catch about x transpose A x being positive. But we'll have to look at this guy. This gets a, like a star, because for most, presentations, the definition of positive definiteness would be this number four, and these numbers one, two, three would be tests for it. OK, maybe I'll tuck this wire in a little bit. OK, so I'll have to look at this x transpose A x. Can you, can we just be sure, how do we know that the eigenvalue test and the determinant test pick out the same matrices? And, and let me, let's just do a few examples. So examples. Let me, let me pick the matrix two, six, six. Tell me, what number do I have to put there for the matrix to be positive definite? Tell me a sufficiently large number that would, would make it positive definite. Just, just let's just practice with these conditions in the two by two case. Now, when I ask you that, you don't want to find the eigenvalues. You would use the determinant test for that. So, so the first, or the pivot test, that, that guy is certainly positive, that had to happen. And it's OK. How large a number here, the number had better be more than what? More than eighteen, right? Because if it's eight, no. More than what? Nineteen, is it? If I have a nineteen here, is that positive definite? Yeah, because the, I get thirty-eight minus thirty-six, that's OK. If I had an eighteen, let me play it really close. If I have an eighteen there, then am I positive definite? Not quite. I would call this guy positive, so it's, it's useful just to see, that this is the borderline. That matrix is on the borderline, I would call that matrix positive semidefinite. And, and what are the eigenvalues of that matrix? Just since we're good at eigenvalues of two by twos. When it's semidefinite but not definite, then the, I'm, I'm squeezing this eigenvalue test down, tell, what's the, what's the, what's the eigenvalue that I know this matrix has? What kind of a matrix have I got here? It's a singular matrix. One of its eigenvalues is zero. That has an eigenvalue zero, and the other eigenvalue is, from the trace, twenty. OK. So that, that matrix has eigenvalues greater than or equal to zero. And it's that equal to that brought this word semidefinite in. And the pi- what are the pivots of that matrix? So the pivots, so the eigenvalues are zero and twenty, the pivots are, well, the pivot is two, and what's the next pivot? There isn't one. We got a singular matrix here, it'll only have one pivot. You see that that's a rank one matrix, two six is a, six eighteen is a multiple of two six. The matrix is singular, it only has one pivot, so the pivot test doesn't quite pass. Let me do the X transpose Ax. Now this is, this is the, this is the, the novelty now. OK. What am I looking at when I look at, at this new combination X transpose Ax? X is any vector now. So let me compute, so any vector, let me call its components x1 and x2. So that's x. And I put in here a. Let's, let's use this example, two six six eighteen. And here's X transpose, so x1 x2. We're back to real matrices. After that last lecture that, that said what to do in the complex case, let's come back to real matrices. So here's X transpose Ax, and what I'm interested in is, what do I get if I multiply those together? I get some function of x1 and x2. And what is it? Let's see. If I do this multiplication, should I do it? Let me, I'll just do it slowly. x1, x2, if I multiply that matrix, this is two x1 and six x2s, and the next row is six x1s and eighteen x2s, and now I do this final step. And what do I have? I've got two x1 squareds. That two x1 squareds is coming from this two. I've got, this one gives me eighteen, well, shall I do the ones in the middle? How many, how many x1 x2s do I have? Let's see, x1 times that six x2 will be six of them, and then x2 times this one will be six more, I get twelve. So in here is going, this is the number A, this is the number 2B, and in here is going to, the x2 times eighteen x2 will be eighteen x2 squareds, and this is the number C. So it's A x1, it's like Ax squared. 2Bxy and Cy squared. So my first point that I wanted to make by just doing out a multiplication is that as soon as you give me the matrix, as soon as you give me the matrix, I can, those are the numbers that appear in the, I'll call this thing a quadratic. You see, it's not linear anymore. Ax is linear, but now I've got an x transpose coming in, I'm up to degree two, up to degree two, maybe quadratic is the usual word, a quadratic form. It's purely degree two. There's no linear part, there's no constant part, there certainly aren't any cubes or fourth powers, it's all second degree. And my question is, is that quantity positive or not? That's my, for every x1 and x2, that is my new definition, that's my definition of a positive definite matrix. If this quantity is positive, if, if, if, it's positive for all x's and y's, all x1, x2's, then I call the, then that's, the matrix is positive definite. Now, is this guy passing our test? Well, we had, we anticipated the answer here by, by asking first about eigenvalues and pivots, and what happened? It failed. It barely failed. If I had made this eighteen down to a seven, it would have totally failed. If I, if I, if I, can I do that with the eraser and then I'll put back eighteen, because I'm, seven is such a total disaster that if, that, well, let me, I'll, I'll keep seven for a second. Is that thing in any way positive definite? No, absolutely not. The, I, I don't know its eigenvalues, but I know for sure one of them is negative. Its pivots are two, and then the next pivot would be the determinant over two, and the determinant is what, what's the determinant of this thing? Fourteen minus thirty-six, so I've got a determinant of minus twenty-two. The next pivot will be, the pivots now of this thing are two and minus eleven or something. Their product being minus twenty-two, the determinant. This thing is not positive definite. What would be, what, let me look at the x transpose Ax for this guy. What's, if I do out this multiplication, this eighteen is temporarily changing to a seven, this eighteen is temporarily changing to a seven, and I know that there's some numbers x1 and x2 for which that thing, that function is negative. And I'm desperately trying to think what they are. Maybe you can see. Can you tell me a value of x1 and x2 that makes this quantity negative? Oh, maybe one and minus one? Yeah, that's a, that's a, in this case, that will work, right. If I took x1 to be one and x2 to be minus one, then I always get something positive, the two and the seven, minus one squares, but this would be minus twelve and the whole thing would be negative. I'd have two minus twelve plus seven, I'm negative. If I drew the graph, can I, can I get a little picture in here? If I draw the graph of this thing, so graphs of the function f of x, y, or f of x, shall I say, or f of x, y, equal this, it's this, it's this x transpose Ax, this, this, this Ax squared, two bxy, and cy squared. And let's take the example with these numbers. OK, so here's the x-axis, here's the y-axis, and here's up, is the function. Z, if you like, or f. I, I apologize, so let me just once in my life here put an arrow over these, these x's so you see that, that's the vector and I just gave, instead of x1 and x2, I made them x, the components x and y. OK. So, so what's a graph of two x squared, twelve xy, and seven y squared? I'd like to see, to get some idea, actually I'm not the greatest artist, but let's, tell me something about this graph of this function. Well, tell me one point that goes through. The origin, right? Even this artist can get this thing to go through the origin. At, at, when these are zero, I, I certainly get zero. OK, some more points. If x is one and y is zero, then I'm going upwards. So I'm going up this way. I'm, I'm going up like two x squared in that direction. So I, that's meant to be a, a parabola. And suppose x stays zero and y increases. Well, y could be positive or negative, it's seven y squared. Is this function going upward? In the x direction it's going upward. And in the y direction it's going upwards. And if x equals y in the forty-five degree direction it's certainly going upwards, because then we'd have, what about, everything would be positive. But, what? This func- what, what, what's the graph of this function look like? Tell me the, tell me the word that describes the graph of this function. This is the non-positive definite. Everybody's with me here. I'm, for some reason, got started in a negative direction here, a case that isn't positive definite. And what's, what's the graph look like? It goes up, but does it, do we have a minimum here? Does it go up from the, from the origin? Completely? No, because we just checked that this thing failed. It failed along the direction when x was minus y. We have a saddle point. Let me, let me put myself, let me at least tell you the word. This thing goes up in some directions, but down in other directions. And if we actually knew what a saddle looked like, I think saddles do that. Like, am I right? I mean, like the way your legs go is like down, and the way you, and looking, like, forward and, and drawing the thing is even worse than describing it. I'm just going to say, in some directions we go up, and in other directions there is a saddle. Now I'm sorry I put that on the front board, because I had no way to, to cover it. But it's a saddle. OK. And, and this is a saddle point. It's the, it's a point that's at the maximum in some directions and at the minimum in other directions. And actually, the perfect directions to look are the eigenvector directions. We'll see that. So this is, not a positive definite matrix. OK. Now I'm coming back to this example, getting rid of this seven, let's move it up to twenty. Let's, let's, let's make the thing really positive definite. OK. So this is, this number is now twenty. C is now twenty. OK. Now that passes the test, which I haven't proved, of course, it passes the test for positive pivots. It passes the test for positive eigenvalues. How, how can you tell that the eigenvalues of that matrix are positive without actually finding them? Of course, two by two I could find them, but can you see, how do I know they're positive? I know that their product is, I know that lambda one times lambda two is positive. Why? Because that's the determinant, right? Lambda one times lambda two is the determinant, which is forty minus thirty-six is four. So the determinant is four. And the trace, the sum down the diagonal is twenty-two. So they multiply to give four. So that leaves the possibility they're either both positive or both negative. But if they're both negative, the trace couldn't be twenty-two, so they're both positive. So both of the eigenvalues there are positive, both of the pivots are positive, the determinants are positive, and I believe that this function is positive everywhere except at zero zero, of course, when I write down this condition. So I believe that x transpose, let me copy, x transpose Ax is positive except, of course, at the minimum point at the zero vector. Of course, I don't expect miracles. So what does its graph look like? And how do I check that this really is positive? Shall we take its graph for a minute? What would be the graph of that function? It does not have a saddle point. Let me, I'll raise the board here and stay with this example for a while. So I want to do the graph of, here's my function, two x squared, twelve x y's, that could be positive or negative, and twenty y squared. My point is, I mean, you're seeing the underlying point is that the things are positive definite when in some way these pure squares, squares we know to be positive. And when those kind of overwhelm this guy, who could be positive or negative, because x and y could have same or different signs, when these are big enough, they overwhelm this guy and make the total thing positive, and what would the graph now look like? Let me draw the x, well, let me draw the x direction, the y direction, and the origin. At zero zero, I'm there. Where do I go as I move away from the origin? Where do I go as I move away from the origin? I'm sure that I go up. The origin, the center point here is a minimum, because this thing, I believe, and we better see why, it's the graph is like a bowl. The graph is like a bowl shaped. It's, it's, it's, here's the minimum. And because we've got a pure quadratic, we know it sits at the origin, we know it's tangent plane, the first derivatives are zero, so we know first derivatives, first derivatives are all zero, but that's not enough for a minimum. First derivatives were zero here. So the partial derivatives, the first derivatives are zero. Again, because first derivatives are going to have an x or a y in them, they'll be zero at the origin. It's the second derivatives that control everything. It's the second derivatives that this matrix is telling us. And somehow second- so here's my point. You remember in calculus, how did you decide on a minimum? First requirement was that the derivative had to be zero. But then you didn't know if you had a minimum or a maximum. To know that you had a minimum, you had to look at the second derivative. The second derivative had to be positive. The, the, the slope had to be increasing as you went through the minimum point. The curvature had to go upwards. And that's what we're doing now in two dimensions and in n dimensions. So we're doing what we did in calculus. Second derivative positive will now become that the matrix of second derivatives is positive definite. Can I just- so this is the, like the translation of, of this is how minimum are coming in. In, in, in, in, in the beginning of calculus, the ques- we had a minimum was associated with second derivative being positive. And first derivative zero, of course. Derivative, first derivative. But it was the second derivative that told us we had a minimum. And now in 18.06, in linear algebra, we'll have a minimum for our function now, our function will have, be a function not of just x, but several variables. The way functions really are in real life. The minimum will be when the matrix of second derivatives, the matrix here was one by one, there was just one second derivative. Now we've got lots. Is positive definite. So positive for a number translates into positive definite for a matrix. And it just brings everything together. You check, you check pivots, you check determinants, you check eigenvalues, or you check this minimum stuff. OK, let me come back to this graph. That graph goes upwards. And I have to see why. How do I know that this function is always positive? Can you look at that and tell that it's always positive? Maybe two by two you could feel pretty sure, but the what's the good way to show that this thing is always positive? If we can express it as in terms of squares, because that's what we know for any x and y whatever, if we're squaring something, we certainly are not negative. So I believe that this expression, this function, could be written as a sum of squares. Can you tell me see, because all the problems, the headaches are coming from this xy term. If we can get expressions, if we can get that inside a square. So actually what we're doing is something called, that you've seen called completing the square. Let me start the square and you complete it. OK, I think we have two of x plus, now I don't know how many y's we need, but you'll figure it out, squared. How many y's should I put in here to make, what do I want to do? The two x squareds will be correct, right? What I want to do is put in the right number of y's to get the 12xy correct. And what is that number of y's? Let's see, I've got two times and so I really want six xy's to come out of here. I think maybe if I put three there, does that look right to you? I have two, this is, we can mentally multiply that out, that's x squared, that's right, that's six xy times the two gives this one right, and how many y squareds have I now got? How many y squareds have I got from this term? Eighteen. Eighteen was the key number, remember? Now if I want to make it twenty, then I've got two left, two y squareds. That's completed the square, and it's, now I can see that that function is positive, because it's all squares. I've got two squares added together, I couldn't go negative. What if, what if it went back to that seven? If instead of twenty, that number was a seven, then what would happen? This would still be correct, I'd still have this square to get the two x squared and the twelve xy, and I'd have eighteen y squared, and then what would I do here? I'd have to remove eleven y squareds, right? If I only had a seven here, then instead of, when I had a twenty, I had two more to put in. When I had an eighteen, which was the marginal case, I had no more to put in. When I had a seven, which was the case below zero, the indefinite case, I had minus eleven. Okay, now, so you can see now that this thing is a bowl. It's going upwards. If I cut it at a plane z equal to one, say, I would get a curve. What would be the equation for that curve? If I cut it at height one, the equation would be this thing equal to one. And that curve would be an ellipse. So actually, already I've brought into the lecture the different pieces that we're aiming for. We're aiming for the tests, which this passed. We're aiming for the connection to a minimum, which this, which we see in the graph. And if we chop it at, if we set this thing equal to one, if I set that thing equal to one, that, what that gives me is the cross-section. It gives me this curve, and its equation is this thing equals one, and that's an ellipse. Whereas if I cut through a saddle point, I'll get a hyperbola. Okay. But this minimum stuff is really what I'm most interested in. Okay. But I, I just have to ask, do you recognize, I mean, these numbers here, the two that appeared outside, the three that appeared inside, the two that appeared there, actually, those numbers come from elimination. Completing the square is our good old method of Gaussian elimination in, expressed in terms of these squares. The, the, let me show you what I mean. I, I just think those numbers are no accident. If I take my matrix, two, six, six, and twenty, and I do elimination, then the pivot is two, and I take three, oh, yeah, what's the multiplier? How much of row one do I take away from row two? Three. So what you're seeing in this, completing the square, is the pivots outside and the multiplier inside. So just do that again. The, the pivot is two, three of, three of those away from that gives me two, six, zero, and what's the second pivot? Three of this away from this, three, six, it'll be eighteen, and the second pivot will also be a two. So that's the, that's the u. This is the a, and of course the l was one, zero, one, and the multiplier was three. So, completing the square is elimination. Why am I happy to see, to see that coming together? Because I know about elimination for n by n matrices. I've just started talking about completing the square here for two by twos. But now I see what's going on. Completing the square really amounts to splitting this thing into a sum of squares. So what's the critical thing? I have a lot of squares, and in, inside those squares are multipliers, but they're squares, and, and the question is, what's outside these squares? When I complete the square, what are the numbers that go outside? They're the pivots. They're the pivots. And that's why positive pivots give me sum of squares. Positive pivots, those pivots are the numbers that go outside the squares, so positive pivots, sum of squares, everything positive, graph goes up, a minimum at the origin, it's all connected together. All connected together. And in the two by two case, you can see those connections, but linear algebra now can go up to three by three, n by n, and let's do that next. Can I just, before I leave two by two, I've written this expression matrix of second derivatives. What's the matrix of second derivatives? It's, that's one second derivative now, but if I'm in, if I'm in two dimensions, I have a two by two matrix, it's the second x derivative, it's the second x derivative goes there, shall I write it? Yeah, I better use the, this is fxx, if you like, fxx. That means the second derivative of f in the x direction. Fyy, second derivative in the y direction. Those are the pure second derivatives. They have to be positive for a minimum. This number has to be positive for a minimum, that number has to be positive for a minimum, but that's not enough. They, those numbers have to somehow be big enough to, to overcome this cross derivative. Why is the matrix symmetric? Because the second derivative of f with respect to x and y is equal to, I can, that's the beautiful fact about second derivatives, is I could do those in either order and I get the same thing. So this is the same as that, and, so, that's the matrix of second derivatives. And the test is, it has to be positive definite. You might remember from, from, tucked in somewhere near the end of 18.02, or at least in the book, was the condition for a minimum for a function of two variables. What's, when do you have a minimum for a function of two variables? And believe me, that's what calculus is for. The condition is first derivatives have to be zero. And the matrix of second derivatives has to be positive definite. So you maybe remember, there was an fxx times an fyy that had to be bigger than an fxy squared, that's just our determinant two by two. But now, we now know the answer for three by three, n by n, because we can do elimination on n by n matrices, we can connect to eigenvalues of n by n matrices, we can do sum of squares, sum of n squares instead of only two squares, and so let's take a, let me go over here to do a three by three example. So three by three example. OK. OK. Oh, let me use, shall I use my favorite matrix? You've seen this matrix before. Let me, yeah, let me, yes, let's use the good matrix. What the, why not? That's, OK. Is that matrix positive definite? What's, so I'm going to ask questions about this matrix. Is it positive definite, first of all? What's the function associated with that matrix? What's the x transpose Ax? Is, do we have a minimum for that function at zero? And then even what's the geometry? OK. First of all, is the matrix positive definite? I've given you the numbers there, so you can take determinants, maybe that's the quickest. Is that what you would do mentally, if I give you a matrix on a quiz and say, is it positive definite or not? I would take that determinant and I'd get the answer two. I would take that determinant and I would get the answer for that two by two determinant, I'd get the answer three. And anybody remember the answer for the three by three determinant? It was four. You remember for these special matrices, when we did determinants, they went up two three four five six, they just went up linearly. So that matrix has the determinants are two three and four. Pivots. What are the pivots for that matrix? I'll tell you, there, the first pivot is two, the next pivot is three over two, the next pivot is four over three. Because the product of the pivots has to give me those determinants. The product of these two pivots gives me that determinant. The product of all the pivots gives me that determinant. What are the eigenvalues? Oh, I don't know. Yeah, the eigenvalues, I've got, what do I have, a cubic equation, a degree three equation? There are three eigenvalues to find. If I believe what I've said today, what do I know about these eigenvalues? Even so I don't know the exact numbers. I might, actually, I think I remember the numbers. Because these matrices are so important that people figure them out. But what do you believe to be true about these three eigenvalues? You believe that they are all positive, right? They're all positive. I think that they are two minus square root of two, two, and two plus the square root of two. I think. Let me just, I can't write those numbers down without checking the simple checks. What's the first simple check is the trace. So if I add those numbers, I get six, and if I add those numbers, I get six. The other simple test is the determinant. If I, am I going to do this? Can you multiply those numbers together? I guess we can multiply by two, okay. What's two minus square root of two times two plus square root of two? That's, that'll be four minus two, that'll be two, yeah, two times two, that's got the determinant right. So it's got a chance of being correct and I think it is. Now what's the x transpose Ax? I better give myself enough room for that. x transpose Ax for this guy. It's two x1 squares and two x2 squares and two x3 squares. Those come from the diagonal, those are easy. Now off the diagonal, there's a minus and a minus, they come together, there'll be a minus two and han- minus two what's are coming from this one two and two one position is, is the x1 x2. I'm, I'm doing mentally a multiplication of this matrix times a row vector on the left times a column vector on the right and I know that these numbers show up in the answer. The diagonal is the perfect squares, this off diagonal is a minus two x1 x2 and there are no x1 x3s and there are minus two x2 x3s. And I believe that that expression is always positive. I believe that that curve, that graph of the, of this function, this is my function f and I'm in more dimensions now than I can draw, it, it, but the graph of that function goes upwards. It's a bowl. Or maybe the right word is, is forgotten. What's a long word for a bowl? Maybe paraboloid, I think paraboloid comes in. I'll, I'll edit the tape and get that word in. Bowl, let's say. Is, that, so that and if I can, I could complete the squares, I could write that as a sum of three squares. And those three squares would get multiplied by the three pivots. And the pivots are all positive. So I would have positive pivots times squares, the net result would be a positive function and a bowl that goes upwards. And then finally, if I cut, if I slice through this bowl, if I, now I'm asking you to stretch your visualization here, because I'm in four dimensions, I've got x1, x2, x3 in the base, and this function is z, or f, or something. And the, its graph is going up, but I'm in four dimensions, because I've got three in the base and then the upward direction. But now if I cut through this four-dimensional picture at level one, so suppose I cut through this thing at height one. So I take all the points that are at height one. That gives me, it gave me an ellipse over there, in that, in that, two by two case. In this case, this will be the equation of an ellipsoid. A football, in other words. Well, not quite a football, a lopsided football. What, what will be, can I, can I try to describe to you what the ellipsoid will look like? This ellipsoid. I'm sorry that the, that I've ended the matrix right at the point, let's, let me, let me be sure you see the, the equation. Two x1 squared, two x2 squared, two x3 squared, minus two of the cross products equal one. That is the equation of, of, of a football. So what do I mean by a football or an ellipsoid? I mean that, well, I'll draw it here. It's like that and like that. It's got a center. And it's got, it's got three principal directions, this, this ellipsoid. So, you, you see what I'm saying? If we had a sphere, then all directions would be the same. If we had a true football, or it's closer to a rugby ball, really, because it's more curved than a football, it would be, it would have one long direction and the other two would be equal. That would be like having a matrix that had one eigenvalue repeated. And then one other different. So the sphere comes from, like, the identity matrix. All eigenvalues the same. Rugby ball comes from a case where, three, the three, two of the three eigenvalues are the same. But we now have a case where, the typical case, where the three eigenvalues are all different. So this will have, how do I say it? If I, if I look at this ellipsoid correctly, it'll have a major axis, it'll have a middle axis, and it'll have a minor axis. And those three axes will be in the direction of the eigenvectors. And the lengths of those axes will be determined by the eigenvalues. I can get, turn this all into linear algebra, because we have the right, we, the right thing we know about eigenvectors and eigenvalues for that matrix is what? Let me just tell you the, repeat the main linear algebra point. How could we turn what I said into, into, into algebra? We would write this A as Q, the eigenvector matrix, times lambda, the eigenvalue matrix, times Q transpose. The principal axis theorem, we'll call it now. The eigenvectors tell us the directions of the principal axes. The eigenvalues tell us the lengths of those axes. Actually, the lengths are, the half lengths are one over the eigenvalues, it turns out. And that is the matrix factorization, which is the most important matrix factorization in our eigenvalue material so far. That's diagonalization for a symmetric matrix, so instead of the inverse, I can write the transpose. Okay. So what I've tried today is to tell you the, what's going on with positive definite matrices. You see all, how all these pieces are there and linear algebra connects them. Okay. See you on Friday.