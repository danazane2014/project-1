 The following content is provided under a Creative Commons license. Your support will help MIT OpenCourseWare continue to offer high quality educational resources for free. To make a donation or to view additional materials from hundreds of MIT courses, visit MIT OpenCourseWare at ocw.mit.edu. OK, let me make a start. On the left, you see the topic for today. So we're doing pretty well. This completes my sort of review of the highlights of linear algebra. So that's five lectures. And I'll follow up on those five points, because the neat part is it really ties together the whole subject. Eigenvalues, energy, A transpose A, determinants, pivots. They all come together. Each one gives a test for positive definite matrices. So that's where I'm going. Claire is hoping to come in for a little bit of the class to ask if anybody has started on the homework and got Julia rolling and got a yes from the auto grader. Did anybody? Is anybody like? No. You're taking a chance, right? Julia, in principle, works. But in practice, it's always an adventure the first time. So we chose this lab on convolution because it was the first lab last time last year. And it doesn't ask for much math at all, really just creating a matrix and getting the auto grader to say, yes, that's the right matrix. And we'll see that matrix. We'll see this idea of convolution at the right time, which is not that far off. It's signal processing. And it's early in part three of the book. OK. So if Claire comes in, she'll answer questions. Otherwise, I guess it would be emailing questions to. I realize that the deadline is not on top of you. And you've got a whole weekend to make Julia fly. All right. So I'll start on the math then. We had symmetric eigenvalues of matrices, and especially symmetric matrices. And those have real eigenvalues. And I'll quickly show why. And orthogonal eigenvectors. And I'll quickly show why. But I want to move to the new idea. Positive definite matrices. So these are the best of the symmetric matrices. They are symmetric matrices that have positive eigenvalues. That's the easy way to remember positive definite matrices. They have positive eigenvalues. But it's certainly not the easy way to test. If I give you a matrix like that, well, that's only 2 by 2. We could actually find the eigenvalues. But we would like to have other tests, easier tests, which would be equivalent to positive eigenvalues. So every one of those five tests, any one of those five tests, is all you need. So let me just start with that example and ask you to look. And then I'm going to discuss those five separate points. But can you see? Well, my question is, is that matrix S? It's obviously symmetric. Is it positive definite or not? OK. So you could compute its eigenvalues since it's 2 by 2, its energy. I'll come back to that because that's the most important one. Number two is really fundamental. Number three would ask you to factor that. Well, you don't want to take time with that. Well, what do you think? Is it positive definite or not? I see an expert in the front row saying no. And why is it no? The answer is no. That's not a positive definite matrix. Where does it let us down? It's got all positive numbers, but that's not what we're asking. We're asking positive eigenvalues, positive determinants, positive pivots. So how does it let us down? Which is the easy test to see that it fails? Determinant. The determinant is 15 minus 16, so negative. And that's what's so how is the determinant connected to the eigenvalues? Everybody? Yep. It's the product. So the two eigenvalues of S, they're real, of course. And they multiply to give the determinant, which is minus 1. So one of them is negative and one of them is positive. This matrix is an indefinite matrix. Indefinite. So how could I make it positive definite? OK. We can just play with an example, and then we see these things happening. Let's see. OK, what shall I put in place of the 5, for example? I could lower the 4, or I can up the 5, or up the 3. I can make the diagonal entries. If I add stuff to the main diagonal, I'm making it more positive. So that's the sort of straightforward way. So what number in there would be safe? 6. 6. OK, 6 would be safe. If I go up from 5 to 6, I've got to do that. So when I say here leading determinants, what does that mean? So that word leading means something. It means that I take the 1 by 1 determinant. It would have to pass that. Just the determinant itself would not do it. Let me give you an example. No for, let me take minus 3 and minus 6. That would have the same determinant. But it's, right, the determinant would still be 18 minus 16, 2. But it fails the test on the 1 by 1. And this passes. This passes the 1 by 1 test and the 2 by 2 test. So that's what this means here. Leading determinants are from the upper left. You have to check n things, because you've got n eigenvalues. And those are the n tests. And have you noticed the connection to pivots? So let's just remember that small item. What would be the pivots? Because we didn't take a long time on elimination. So what would be the pivots for that matrix, 3, 4, 4, 6? Well, what's the first pivot? 3, sitting there. The 1, 1 entry would be the first pivot. So the pivots would be 3. And what's the second pivot? Well, maybe to see it clearly, you want me to take that elimination step. Why don't I do it, just so you'll see it here? So elimination would subtract some multiple of row 1 from row 2. I would leave row 1 alone. I would subtract some multiple to get a 0 there. And what's the multiple? What's the multiplier? In that much? 4 3rds. 4 3rds times row 1, away from row 2, would produce that 0. But 4 3rds times the 4, that would be 16 3rds. And we're subtracting it from 18 3rds. I think we've got 2 3rds left. So the pivots, which is in elimination, are the 3 and the 2 3rds. And of course, they're positive. And actually, you see the immediate connection. This pivot is the 2 by 2 determinant divided by the 1 by 1 determinant. The 2 by 2 determinant, we figured out, 18 minus 16 was 2. The 1 by 1 determinant is 3. And sure enough, that second pivot is 2 3rds. So by example, I'm illustrating what these different tests. And again, each test is all you need. If it passes one test, it passes them all. And we haven't found the eigenvalues. Let me do the energy. Can I do energy here? OK, so what's this? I'm saying that this is really the great test. For me, that's the definition of a positive definite matrix. And the word energy comes in because it's quadratic, the way kinetic energy or potential energy. So that's the energy in the vector x for this matrix. So let me compute it, x transpose Sx. So let me put in S here, the original S. And let me put in any vector x, so say xy or x1. Maybe you like xy. It's easier. So that's our vector x transpose. This is our matrix S. And here's our vector x. So it's a function of x and y. It's a pure quadratic function. Do you know what I get when I multiply that out? I get a very simple, important type of function. Shall we multiply it out? Let's see, shall I multiply that by that first? So I get 3x plus 4y and 4x plus 6y is what I'm getting from these two. And now I'm hitting that with the xy. And now I'm going to see the energy. And you'll see the pattern. That's always what math is about, what's the pattern. So I have x times 3x, 3x squared. And I have y times 6y. That's 6y squared. And I have x times 4y. That's 4xy's. And I have y times 4x. That's four more xy's. So I've got all those terms. Every term in the, every number in the matrix gives me a piece of the energy. And you see that the diagonal numbers, 3 and 6, those give me the diagonal pieces, 3x squared and 6y squared. And then the cross, what I maybe call them the cross terms, those give me 4xy and 4xy, so really 8xy. So you could call this thing 8xy. 8xy. So that's my function. That's my quadratic. That's my energy. And I believe that that is greater than 0. Let me graph the thing. Let me graph that energy. OK, so here's a graph of my function f of x and y. OK, here's x and here's y. And of course, that's on the graph, 0, 0. At x equals 0, y equals 0, the function is clearly 0. Everybody's got his eye. Let me write that function again here. 3x squared, 6y squared, 8xy. 8xy. Actually, you can see this is how I think about that function. So 3x squared is obviously carrying me upwards. It will never go negative. 6y squared will never go negative. 8xy can go negative, right? If x and y have opposite signs, that will go negative. But the question is, do these positive pieces overwhelm it and make the graph go up like a bowl? And the answer is yes for a positive definite matrix. So this is a graph of a positive definite matrix, of a positive energy, the energy of a positive definite matrix. So this is the energy x transpose Sx that I'm graphing. And there it is. This is important. This is important. This is the kind of function we like, x transpose Sx, where S is positive definite. So the function goes up like that. This is what deep learning is about. This could be a loss function that you minimize. It could depend on 100,000 variables or more. And it could come from the error in the difference between training data and the number you get. The loss would be some expression like that. Well, I'll make sense of those words as soon as I can. What I want to say is deep learning, neural nets, machine learning, the big computation is to minimize an energy, is to minimize an energy. Now, of course, I made the minimum easy to find, because I have pure squares. Well, that doesn't happen in practice, of course. In practice, we have linear terms, x transpose B, or nonlinear. Yeah, the loss function doesn't have to be a thing, cross-entropy, all kinds of things. There's a whole dictionary of possible loss functions. But this is the model. This is the model. And I'll make it the perfect model by just focusing on that part. Well, yeah, by the way, what would happen if that was in there? I shouldn't have x-ed it out so well, so quickly, since I just put it up there. Let me put it back up. I thought better of it. OK, this is a kind of least squares problem, with some data B. Minimize that. So what would be the graph of this guy? Can I just draw the same sort of picture for that function? Will it be a bowl? Yes. If I have this term, all that does is move it off center here. At x equals 0, well, I still get 0. Sorry, I still go through that point. If this is the 0 vector, I'm still getting 0. But this, we'll bring it below. That would produce a bowl like that. Actually, it would just be the same bowl. The bowl would just be shifted. I could write that to show how that happens. So this is now below 0. That's the solution we're after that tells us the weights in the neural network. I'm just using these words, but we'll soon have a meaning to them. I want to find that minimum, in other words. And I want to find it for much more complicated functions than that. Of course, if I minimize a quadratic, that means setting derivatives to 0. I just have linear equations. Probably I could write everything down for that thing. So let's put in some nonlinear stuff, which wiggles the bowl, makes it not so easy. Can I look a month ahead? How do you find? So this is a big part of mathematics, applied math. Optimization, minimization of a complicated function of 100,000 variables. That's the biggest computation. That's the reason machine learning on big problems takes a week on a GPU or multiple GPUs, because you have so many unknowns. More than 100,000 would be quite normal. In general, let's just have the pleasure of looking ahead for one minute, and then I'll come back to real life here, linear algebra. I can't resist thinking aloud, how do you find the minimum? By the way, these functions, both of them, are convex. So that is convex. Convex, so I want to connect convex functions f. And what does convex mean? It means, well, that the graph is like that. Yeah, I mean, not perfect. It could, but if it's a quadratic, then convex means positive definite, or maybe at the extreme, positive semi-definite. I'll have to mention that. Yeah. But convex means it goes up, but it could have wiggles. It doesn't have to be just perfect squares and linear terms, but general things. And for deep learning, it will include none. It'll go far beyond quadratics. But, well, it may not be convex, I guess. That's also true. Yeah, so deep learning has got serious problems, because those functions, they may look like this, but then over here, they could go non-convex. They could dip down a little more, and you're looking for this point or for this point. Hm. Still, I'm determined to tell you how to find it, or a start on how you find it. So you're at some point. Right, start there. Somewhere on the surface, some x. Some vector x is your start, x0. Starting there. And we're going to just take a step, hopefully, down. Down the bowl. Well, of course, it would be fantastic to get there in one step, but that's not going to happen. That would be solving a big linear system, very expensive, and a big non-linear system. So really, that's what we're trying to solve, a big non-linear system. And I should be on this picture, because here we can see where the minimum is. But it just shifts. So what would you do if you had a starting point and you wanted to go look for the minimum? What's the natural idea? Compute derivatives. You've got calculus on your side. Compute the first derivatives. So the first derivatives with respect to x. So I would compute the derivative of f with respect to x and the derivative of f with respect to y, and 100,000 more. And that takes a little while. And now I've got the derivatives. What do I do? I go. That tells me the steepest direction. That tells me, at that point, which way is fastest way down. So I would do a gradient descent. I would follow that gradient. This is called the gradient. All the first derivatives is called the gradient of f, the gradient. Gradient vector. It's a vector, of course, because f is a function of lots of variables. I would start down in that direction. And how far to go? That's like the million dollar question in deep learning. Is it going to hit 0? Nope. It's not. It's not. And so basically, you go down until you go. So you're traveling here in the x along the gradient. And you're not going to hit 0. You're going here in some direction. And you want to go. So you keep going down this thing until it. Oh, my. I'm not Rembrandt here. Your path down. Think of yourself on a mountain. You're trying to go downhill. So you take as fast as you can. So you take the steepest route down until. But you have blinkers on. And once you decide on a direction, you go in that direction. Of course, yeah. So what will happen? You'll go down for a while. And then it will turn up again, right? When you get maybe close to the bottom or maybe not. You're not going to hit here. And it's going to miss that and come up. Maybe I should draw it over here, whatever. So this is called a line search to decide how far to go there and then say, OK, stop. And you can invest a lot of time or a little time to decide on that first stopping point. And now just tell me, what do you do next? So now you're here. What now? Recalculate the gradient. Find the steepest way down from that point. Follow it until it turns up or approximately. Then you're at a new point. So this is gradient descent. That's gradient descent, the big algorithm of deep learning of neural nets, of machine learning, of optimization, you could say. Notice that we didn't compute second derivatives. If we computed second derivatives, we could have a fancier formula that could account for the curve here. But to compute second derivatives when you've got hundreds of thousands of variables is not a lot of fun. So most effectively, machine learning is limited to first derivatives, the gradient. So OK, so that's the general idea. But there are lots and lots of decisions. And how well does that work maybe is a good question to ask. Does this work pretty well? Or do we have to add more ideas? Well, it doesn't always work well. Let me tell you what the trouble is. So I'm way off. This is like March or something. But anyway, I'll finish the sentence. So what's the problem with this gradient descent idea? It turns out if you're going down a narrow valley, I don't know if you can sort of imagine a narrow valley toward the bottom. So here's the bottom. Here's your starting point. And this is, so I mean, you have to think of this as a bowl. So yeah, the bowl is, or the two eigenvalues, you could say, are one and a very small number. The bowl is long and thin. Are you with me? Imagine a long, thin bowl. Then what happens for that case? You take steepest descent, but you cross the valley, and very soon you're climbing again. So you take very small steps, just staggering back and forth across this and getting slowly, but too slowly, toward the bottom. So that's why things have got to be improved. If you have eigenvalue, a very small eigenvalue and a very large eigenvalue, those tell you the shape of the bowl, of course. And many cases will be like that, have a small and a large eigenvalue, and then you're spending all your time. You're quickly going up the other side, down, up, down, up, down, and you need a new idea. OK, so that's really, so this is one major reason why positive definite is so important, because positive definite gives pictures like that. But then we have this question of, are the eigenvalues sort of the same size? Of course, if the eigenvalues are all equal, what's my bowl like? Suppose I have the identity. So that's x squared plus y squared is my function. Then it's a perfectly circular bowl. What will happen if I, can you imagine a perfectly circular, like any bowl in the kitchen is probably most likely circular. And suppose I do gradient descent there. I start at some point on this perfectly circular bowl. I start down, and where do I stop in that case? Do I hit bottom? I do. By symmetry, I'm going to, so if I take x squared plus y squared as my function, and I start somewhere, I figure out the gradient. Yeah, the answer is I'll go right through the center. So really, it's positive eigenvalues, positive definite matrices give us a bowl. But if the eigenvalues are far apart, that's when we have problems. OK. I'm going back to my job, which is this, this. Because you really, this is so nice. Yeah, right. Could you, well, the homework that's maybe going out this minute for middle of next week gives you some exercises with this. But let me do a couple of things, a couple of exercises here. For example, suppose I have a positive definite matrix S and a positive definite matrix T. If I add those matrices, is the result positive definite? So there's a perfect math question, and we hope to answer it. So S and T, positive definite. What about S plus T? Is that matrix positive definite? OK. How do I answer such a question? I look at my five tests, and I think, can I use it? Which one will be good? And one that won't tell me much is the eigenvalues, because the eigenvalues of S plus T are not immediately clear from the eigenvalues of S and T separately. I don't want to use that test. This is my favorite test, so I'm going to use that. What about the energy in, so look at the energy. OK, so I look at X transpose S plus T, X. And what's my question in my mind here? Is that a positive number or not for every X? And how am I going to answer that question? Just separate those into two pieces. It's there in front of me. It's this one plus this one. And both of those are positive, so the answer is yes. It is positive definite, yes. You see how the energy just was right. I don't want to compute the pivots or any determinants. That would be like a nightmare, trying to find the determinants for S plus T. But this one just does it immediately. What else would be a good example to start with? What about S inverse? Is that positive definite? So let me ask S positive definite, and I want to ask about its inverse. So its inverse is a symmetric matrix. And is it positive definite? And the answer, yes, yes. I've got five tests, 20% chance of picking the right one. Determinants, not good. The first one is great. The first one is the good one for this question, because the eigenvalues. So the answer is yes. It is yes. This has eigenvalues. So what are the eigenvalues of S inverse? 1 over lambda. So yes, positive definite. Right. Yep. What about, yeah, let me ask just one more question of this same sort. Suppose I have a matrix S, and suppose I multiply it by another matrix. Oh, well, OK. Suppose, yeah. Yeah. Do I want to ask you this? Suppose I asked you about S times another matrix M. Would that be positive definite or not? Now, I'm going to tell you the answer is that the question wasn't any good, because that matrix is probably not symmetric. And I'm only dealing with symmetric matrices. Matrices have to be symmetric before I know they have real eigenvalues, and I can ask these questions. So that's not good. But I could, oh, let's see. Oh, well, let me here. Yeah. Let me put in an orthogonal guy. Well, still, that's not symmetric. But if I put the, it's transpose over there, then I made it symmetric. Oh, dear. I may be getting myself in trouble here. So I'm starting with a positive definite S. I'm hitting with an orthogonal matrix, and it's transpose. And sort of my instinct carried me here, because I know that that's still symmetric. Everybody sees that? If I transpose this, Q transpose will come here. S, Q will go there. It'll be, check, symmetric. Now, is that positive definite? Ah, yes, we can answer that. Can we? Is that positive definite? So remember that this is an orthogonal matrix. So I'm also, if you wanted me to write it that way, I could. And what about positive definiteness of that thing? The answer, I think, is yes. Do you agree? It is positive definite. Give me a reason, though. Why is this positive definite? So that word similar. So this is a similar matrix to S. Do you remember what similar means from last time? It means that some M and its inverse are here, which they are. And so what's the consequence of being similar? What do I know about a matrix that's similar to S? It has the same eigenvalues, and therefore, we're good. Or I could go this way. I could, I like energy, so let me try that one. X transpose Q transpose SQX, that would be the energy. And what am I trying to show? I'm trying to show it's positive. So of course, as soon as I see that, like just waiting for me to let QX be something called Y, maybe, and then what will this be? Y transpose. So this energy would be the same as Y transpose SY. And what do I know about that? It's positive, because that's an energy in the Y for the Y vector. So one way or another, we get the answer yes to that question. Let me introduce the idea of semidefinite. Semidefinite is the borderline. So what did we have? We had 3, 4, 4. And then when it was 5, you told me indefinite, a negative eigenvalue. When it was 6, you told me two positive eigenvalues, definite. What's the borderline? What's the borderline there? It's not going to be an integer, but it's what do I mean? What am I looking for at the borderline? 16. 16. So tell me again. 16 over 3. 16 over 3. That sounds right. Why is that the borderline? Because now the determinant is? 0. 0. It's singular. It has a 0 eigenvalue. There's a 0 eigenvalue. So that's what semidefinite means. Lambdas are greater or equal to 0. Wait a minute. That has a 0 eigenvalue because its determinant is 0. How do I know that the other eigenvalue is positive? Could it be that the other eigenvalue? So this is the semidefinite case, we hope. But we better finish that reasoning. How do I know that the other eigenvalue is positive? Trace. The trace. Because adding 3 plus 16 over 3, whatever the heck that might give, it certainly gives a positive number. And that will be lambda 1 plus lambda 2. That's the trace. But lambda 2 is 0. We know from this. It's singular. So we know lambda 2 is 0. So lambda 1 must be 3 plus 5. 5 and 1 3rd must. The lambdas must be 8 and 1 3rd. 3 plus 5 and 1 3rd and 0. So that's a positive semidefinite. If you think of the positive definite matrices as some clump in matrix space, then the positive semidefinite ones are sort of the edge of that clump. They're the boundary of the clump, the ones that are not quite inside but not outside either. They're lying right on the edge of positive definite matrices. Let me just take a. So what about a matrix of all 1's? What's the story on that one? Positive definite? All the numbers are positive. Or positive semidefinite or indefinite? What do you think here? All 1's. AUDIENCE 1. Semi. Semi-definite? Sounds like a good guess. Do you know what the eigenvalues of this matrix would be? 0. 3 0 and 0. 3 0 and 0. Why did you say that? To literally keep them in columns. Because we only have the rank is? 1 1. Yeah, well, introduce that keyword. The rank is 1. So there's only one non-zero eigenvalue. And then the trace tells me that that number is 3. So this is a positive, positive semidefinite matrix. So all these tests change a little for semidefinite. The eigenvalue is greater or equal to 0. The energy is greater or equal to 0. The A transpose A, but now I don't require. Oh, I didn't discuss this. But semidefinite would allow dependent columns. By the way, you've got to do this for me. Write that matrix as A transpose times A, just to see that it's semidefinite. So write that as A transpose A. Yeah. If it's a rank 1 matrix, you know what it must look like. A transpose A, how many terms am I going to have in this? And now I'm thinking back to the very beginning of this course. If I pulled off the pieces, in general, this is lambda 1 times the first eigenvector times the first eigenvector transpose. AUDIENCE 1 Would A just be a vector of three 1's? GILBERT STRANGSKII Yeah, it would just be a vector of three 1's. Yeah, so this would be the usual picture. This is the same as the Q lambda Q transpose. This is the big fact for any symmetric matrix. And this is symmetric. But its rank is only 1, so that lambda 2 is 0 for that matrix. Lambda 3 is 0 for that matrix. And the one eigenvector is the vector 1, 1, 1. So this would be 3 times 1, 1, 1. Oh, I have to do. Yeah. So I was going to do 3 times 1, 1, 1 times 1, 1, 1. But that gives me 3, 3, 3. That's not right. I have to normalize them. That's right. Yeah, so that's a vector whose length is square root of 3. So I have to divide by that. I have to divide by it. And then the 3 cancels the square root of 3's. And I'm just left with the 1, 1, 1, 1, 1, 1. Yeah. So there is a matrix, one of our building block type matrices, because it only has one non-zero eigenvalue. Its rank is 1. So it could not be positive definite. It's singular. But it is positive semi-definite, because that eigenvalue is positive. OK. So you've got the idea of positive definite matrices. Again, any one of those five tests is enough to show that it's positive definite. And so what's my goal next week is the singular value decomposition and all that that leads us to. We're there now, ready for the SVD. OK, have a good weekend. And see you. Oh, I see you on Tuesday, I guess, right? Not Monday, but Tuesday next week.